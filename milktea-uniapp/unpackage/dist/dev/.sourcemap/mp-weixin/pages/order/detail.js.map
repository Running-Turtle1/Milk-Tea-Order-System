{"version":3,"file":"detail.js","sources":["pages/order/detail.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"detail-container\">\n\t\t<!-- 顶部导航栏 -->\n\t\t<view class=\"navbar\">\n\t\t\t<view class=\"back-btn\" @click=\"goBack\">\n\t\t\t\t<image src=\"/static/icons/common/back.svg\" class=\"back-icon\"></image>\n\t\t\t</view>\n\t\t\t<view class=\"title\">订单详情</view>\n\t\t\t<view class=\"navbar-right\"></view>\n\t\t</view>\n\t\t\n\t\t<!-- 加载中提示 -->\n\t\t<view class=\"loading-box\" v-if=\"loading\">\n\t\t\t<view class=\"loading-spinner\"></view>\n\t\t\t<text class=\"loading-text\">加载中...</text>\n\t\t</view>\n\t\t\n\t\t<!-- 使用scroll-view作为主滚动容器 -->\n\t\t<scroll-view \n\t\t\tv-else\n\t\t\tscroll-y \n\t\t\t:scroll-top=\"scrollTop\" \n\t\t\tclass=\"detail-scroll-view\" \n\t\t\tenable-back-to-top\n\t\t\t:enhanced=\"true\"\n\t\t\t:bounces=\"true\"\n\t\t\t:show-scrollbar=\"true\"\n\t\t\t@scroll=\"onScroll\"\n\t\t>\n\t\t\t<!-- 订单状态卡片 -->\n\t\t\t<view class=\"status-card\">\n\t\t\t\t<view class=\"status-header\">\n\t\t\t\t\t<text class=\"status-text\">{{orderStatusText}}</text>\n\t\t\t\t\t<text class=\"order-id\">订单号: {{orderDetail.orderNo}}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"status-timeline\" v-if=\"orderDetail.status !== 5\">\n\t\t\t\t\t<view class=\"timeline-item\" :class=\"{'completed': orderDetail.status >= 0}\">\n\t\t\t\t\t\t<view class=\"timeline-dot\"></view>\n\t\t\t\t\t\t<view class=\"timeline-info\">\n\t\t\t\t\t\t\t<text class=\"timeline-title\">订单已提交</text>\n\t\t\t\t\t\t\t<text class=\"timeline-time\" v-if=\"orderDetail.createdAt\">{{formatDate(orderDetail.createdAt)}}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"timeline-line\" :class=\"{'completed': orderDetail.status >= 1}\"></view>\n\t\t\t\t\t<view class=\"timeline-item\" :class=\"{'completed': orderDetail.status >= 1}\">\n\t\t\t\t\t\t<view class=\"timeline-dot\"></view>\n\t\t\t\t\t\t<view class=\"timeline-info\">\n\t\t\t\t\t\t\t<text class=\"timeline-title\">支付成功</text>\n\t\t\t\t\t\t\t<text class=\"timeline-time\" v-if=\"orderDetail.paymentTime\">{{formatDate(orderDetail.paymentTime)}}</text>\n\t\t\t\t\t\t\t<text class=\"timeline-time\" v-if=\"orderDetail.takeNo\">取餐号: {{orderDetail.takeNo}}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"status-canceled\" v-else>\n\t\t\t\t\t<text class=\"canceled-text\">订单已取消</text>\n\t\t\t\t\t<text class=\"canceled-time\" v-if=\"orderDetail.cancelTime\">{{formatDate(orderDetail.cancelTime)}}</text>\n\t\t\t\t\t<!-- 退款信息 -->\n\t\t\t\t\t<view class=\"refund-info\" v-if=\"orderDetail.refundInfo\">\n\t\t\t\t\t\t<text class=\"refund-reason\">退款原因: {{orderDetail.refundInfo.reason || '无'}}</text>\n\t\t\t\t\t\t<text class=\"refund-time\" v-if=\"orderDetail.refundInfo.refundTime\">退款时间: {{formatDate(orderDetail.refundInfo.refundTime)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 取餐信息 -->\n\t\t\t<view class=\"detail-section\" v-if=\"orderDetail.status === 1\">\n\t\t\t\t<view class=\"section-title\">取餐信息</view>\n\t\t\t\t<view class=\"pickup-info\">\n\t\t\t\t\t<view class=\"pickup-item\">\n\t\t\t\t\t\t<text class=\"pickup-value\">{{orderDetail.takeNo}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"pickup-note\">\n\t\t\t\t\t\t<text>请凭取餐号到门店取餐</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 商品信息 -->\n\t\t\t<view class=\"detail-section\">\n\t\t\t\t<view class=\"section-title\">商品信息</view>\n\t\t\t\t<view \n\t\t\t\t\tclass=\"product-item\" \n\t\t\t\t\tv-for=\"(product, index) in orderDetail.orderDetails\" \n\t\t\t\t\t:key=\"index\"\n\t\t\t\t>\n\t\t\t\t\t<image class=\"product-image\" :src=\"product.productImage\" mode=\"aspectFill\"></image>\n\t\t\t\t\t<view class=\"product-info\">\n\t\t\t\t\t\t<view class=\"product-name\">{{product.productName}}</view>\n\t\t\t\t\t\t<view class=\"product-spec\" v-if=\"product.temperature || product.sweetness\">\n\t\t\t\t\t\t\t<text v-if=\"product.temperature\">{{product.temperature}}</text>\n\t\t\t\t\t\t\t<text v-if=\"product.temperature && product.sweetness\"> / </text>\n\t\t\t\t\t\t\t<text v-if=\"product.sweetness\">{{product.sweetness}}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t<view class=\"product-ingredients\" v-if=\"product.ingredients && product.ingredients.length > 0\">\n\t\t\t\t\t\t\t配料: \n\t\t\t\t\t\t\t<text v-for=\"(ing, iIndex) in product.ingredients\" :key=\"iIndex\">\n\t\t\t\t\t\t\t\t{{ing.name}}{{iIndex < product.ingredients.length - 1 ? '、' : ''}}\n\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"product-price-qty\">\n\t\t\t\t\t\t<view class=\"product-price\">¥{{product.price.toFixed(2)}}</view>\n\t\t\t\t\t\t<view class=\"product-qty\">x{{product.quantity}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 订单金额 -->\n\t\t\t<view class=\"detail-section\">\n\t\t\t\t<view class=\"section-title\">订单金额</view>\n\t\t\t\t<view class=\"price-list\">\n\t\t\t\t\t<!-- 商品总价 -->\n\t\t\t\t\t<view class=\"price-item\">\n\t\t\t\t\t\t<text class=\"price-label\">商品总价</text>\n\t\t\t\t\t\t<text class=\"price-value\">¥{{orderDetail.totalAmount.toFixed(2)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 优惠金额 -->\n\t\t\t\t\t<view class=\"price-item\" v-if=\"orderDetail.couponAmount > 0\">\n\t\t\t\t\t\t<text class=\"price-label\">优惠金额</text>\n\t\t\t\t\t\t<text class=\"price-value discount\">-¥{{orderDetail.couponAmount.toFixed(2)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<!-- 实付金额 -->\n\t\t\t\t\t<view class=\"price-item total\">\n\t\t\t\t\t\t<text class=\"price-label\">实付金额</text>\n\t\t\t\t\t\t<text class=\"price-value\">¥{{(orderDetail.displayAmount || orderDetail.paymentAmount).toFixed(2)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 支付信息 -->\n\t\t\t<view class=\"detail-section\" v-if=\"orderDetail.status > 0\">\n\t\t\t\t<view class=\"section-title\">支付信息</view>\n\t\t\t\t<view class=\"payment-info\">\n\t\t\t\t\t<view class=\"payment-item\">\n\t\t\t\t\t\t<text class=\"payment-label\">支付方式</text>\n\t\t\t\t\t\t<text class=\"payment-value\">{{getPaymentMethodText(orderDetail.paymentMethod)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"payment-item\" v-if=\"orderDetail.paymentTime\">\n\t\t\t\t\t\t<text class=\"payment-label\">支付时间</text>\n\t\t\t\t\t\t<text class=\"payment-value\">{{formatDate(orderDetail.paymentTime)}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"payment-item\" v-if=\"orderDetail.transactionId\">\n\t\t\t\t\t\t<text class=\"payment-label\">交易单号</text>\n\t\t\t\t\t\t<text class=\"payment-value\">{{orderDetail.transactionId}}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 订单操作按钮 -->\n\t\t\t<view class=\"detail-actions\" v-if=\"orderDetail.status === 0\">\n\t\t\t\t<button class=\"action-btn cancel-btn\" @click=\"cancelOrder\">取消订单</button>\n\t\t\t\t<button class=\"action-btn pay-btn\" @click=\"payOrder\">去支付</button>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 底部安全区域，确保内容不被遮挡 -->\n\t\t\t<view class=\"safe-area-inset-bottom\"></view>\n\t\t</scroll-view>\n\t\t\n\t\t<!-- 支付确认弹窗 -->\n\t\t<view class=\"payment-popup\" v-if=\"showPaymentPopup\">\n\t\t\t<view class=\"popup-mask\" @click=\"closePopup\"></view>\n\t\t\t<view class=\"popup-content\">\n\t\t\t\t<view class=\"popup-header\">\n\t\t\t\t\t<text class=\"popup-title\">订单支付</text>\n\t\t\t\t\t<text class=\"popup-close\" @click=\"closePopup\">×</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"popup-body\">\n\t\t\t\t\t<view class=\"payment-amount-info\">\n\t\t\t\t\t\t<view class=\"payment-amount\">¥{{ orderDetail.paymentAmount.toFixed(2) }}</view>\n\t\t\t\t\t\t<view class=\"payment-order-no\">订单号: {{orderDetail.orderNo || ''}}</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"payment-methods\">\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tclass=\"payment-method-item\" \n\t\t\t\t\t\t\t:class=\"{'active': paymentMethod === 'wechat'}\"\n\t\t\t\t\t\t\t@click=\"selectPaymentMethod('wechat')\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"payment-method-content\">\n\t\t\t\t\t\t\t\t<view class=\"payment-icon payment-icon-wechat\">\n\t\t\t\t\t\t\t\t\t<image src=\"/static/icons/payment/wechat.svg\" mode=\"aspectFit\" class=\"payment-icon-img\"></image>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<text class=\"payment-name\">微信支付</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<text class=\"payment-select\" v-if=\"paymentMethod === 'wechat'\">✓</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tclass=\"payment-method-item\" \n\t\t\t\t\t\t\t:class=\"{'active': paymentMethod === 'alipay'}\"\n\t\t\t\t\t\t\t@click=\"selectPaymentMethod('alipay')\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"payment-method-content\">\n\t\t\t\t\t\t\t\t<view class=\"payment-icon payment-icon-alipay\">\n\t\t\t\t\t\t\t\t\t<image src=\"/static/icons/payment/alipay.svg\" mode=\"aspectFit\" class=\"payment-icon-img\"></image>\n\t\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\t<text class=\"payment-name\">支付宝</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<text class=\"payment-select\" v-if=\"paymentMethod === 'alipay'\">✓</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"popup-footer\">\n\t\t\t\t\t<button class=\"confirm-payment-btn\" @click=\"confirmPayment\">确认支付</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport api from '@/utils/api.js';\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tloading: true,\n\t\t\t\torderNo: '',\n\t\t\t\torderDetail: {},\n\t\t\t\tshowPaymentPopup: false,\n\t\t\t\tpaymentMethod: 'wechat',\n\t\t\t\tscrollTop: 0 // 新增滚动位置控制\n\t\t\t}\n\t\t},\n\t\tcomputed: {\n\t\t\torderStatusText() {\n\t\t\t\tswitch(this.orderDetail.status) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\treturn '待支付';\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\treturn '已支付';\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\treturn '已完成';\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\treturn '退款中';\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\treturn '已退款';\n\t\t\t\t\tcase 5:\n\t\t\t\t\t\treturn '已取消';\n\t\t\t\t\tcase 6:\n\t\t\t\t\t\treturn '拒绝退款';\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn '未知状态';\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonLoad(options) {\n\t\t\tif (options.orderNo) {\n\t\t\t\tthis.orderNo = options.orderNo;\n\t\t\t\tthis.loadOrderDetail();\n\t\t\t} else {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '订单号不存在',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.goBack();\n\t\t\t\t}, 1500);\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\t// 新增滚动事件处理\n\t\t\tonScroll(e) {\n\t\t\t\t// 可用于处理滚动事件\n\t\t\t},\n\t\t\t\n\t\t\t// 返回上一页\n\t\t\tgoBack() {\n\t\t\t\t// 如果订单未支付或已取消，返回到订单列表页（tabBar页面）\n\t\t\t\tif (this.orderDetail && (this.orderDetail.status === 0 || this.orderDetail.status === 5)) {\n\t\t\t\t\tconsole.log('订单状态:', this.orderDetail.status, '跳转到订单列表页');\n\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\turl: '/pages/order/order'\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// 其他状态直接返回上一页\n\t\t\t\t\tconsole.log('订单状态:', this.orderDetail.status, '返回上一页');\n\t\t\t\t\tuni.navigateBack();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 加载订单详情\n\t\t\tloadOrderDetail() {\n\t\t\t\tthis.loading = true;\n\t\t\t\t\n\t\t\t\tapi.getOrderDetail(this.orderNo)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('订单详情响应:', res.data);\n\t\t\t\t\t\tif (res.data.code === 200) {\n\t\t\t\t\t\t\tlet orderData = res.data.data;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 确保有优惠金额字段\n\t\t\t\t\t\t\tif (typeof orderData.couponAmount === 'undefined') {\n\t\t\t\t\t\t\t\t// 如果后端没有返回优惠金额，尝试从其他字段计算\n\t\t\t\t\t\t\t\tif (orderData.totalAmount && orderData.paymentAmount) {\n\t\t\t\t\t\t\t\t\torderData.couponAmount = orderData.totalAmount - orderData.paymentAmount;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\torderData.couponAmount = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tthis.orderDetail = orderData;\n\t\t\t\t\t\t\tconsole.log('处理后的订单数据:', this.orderDetail);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: res.data.message || '获取订单详情失败',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('网络请求失败:', err);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 格式化日期\n\t\t\tformatDate(dateStr) {\n\t\t\t\tif (!dateStr) return '';\n\t\t\t\t\n\t\t\t\t// 假设日期格式: 2025-04-24 18:47:20\n\t\t\t\tconst parts = dateStr.split(' ');\n\t\t\t\tif (parts.length >= 1) {\n\t\t\t\t\tconst datePart = parts[0];\n\t\t\t\t\tconst timePart = parts.length > 1 ? parts[1] : '';\n\t\t\t\t\t\n\t\t\t\t\treturn `${datePart} ${timePart.substring(0, 5)}`;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn dateStr;\n\t\t\t},\n\t\t\t\n\t\t\t// 获取支付方式文本\n\t\t\tgetPaymentMethodText(method) {\n\t\t\t\tswitch(method) {\n\t\t\t\t\tcase 'wechat':\n\t\t\t\t\t\treturn '微信支付';\n\t\t\t\t\tcase 'alipay':\n\t\t\t\t\t\treturn '支付宝';\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn method || '未知方式';\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 取消订单\n\t\t\tcancelOrder() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent: '确定要取消该订单吗？',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\tuni.showLoading({\n\t\t\t\t\t\t\t\ttitle: '取消中...'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tapi.cancelOrder(this.orderNo)\n\t\t\t\t\t\t\t\t.then(res => {\n\t\t\t\t\t\t\t\t\tconsole.log('取消订单响应:', res.data);\n\t\t\t\t\t\t\t\t\tif (res.data.code === 200) {\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\ttitle: '订单已取消',\n\t\t\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t// 设置状态为已取消，延迟两秒后跳转到订单列表页\n\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\t// 更新当前订单状态为已取消(5)\n\t\t\t\t\t\t\t\t\t\t\tif (this.orderDetail) {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.orderDetail.status = 5;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\t\t\t\t\t\turl: '/pages/order/order'\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\t\ttitle: res.data.message || '取消订单失败',\n\t\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\t\t\t\tconsole.error('网络请求失败:', err);\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 显示支付弹窗\n\t\t\tpayOrder() {\n\t\t\t\tthis.showPaymentPopup = true;\n\t\t\t\t// 弹窗打开时初始化默认支付方式为微信支付\n\t\t\t\tthis.paymentMethod = 'wechat';\n\t\t\t},\n\t\t\t\n\t\t\t// 关闭弹窗\n\t\t\tclosePopup() {\n\t\t\t\tthis.showPaymentPopup = false;\n\t\t\t},\n\t\t\t\n\t\t\t// 确认支付\n\t\t\tconfirmPayment() {\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '支付中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 确认当前选择的支付方式\n\t\t\t\tconst currentPaymentMethod = this.paymentMethod;\n\t\t\t\tconsole.log('[确认支付] 准备支付订单:', this.orderNo);\n\t\t\t\tconsole.log('[确认支付] 选择的支付方式:', currentPaymentMethod);\n\t\t\t\t\n\t\t\t\t// 使用api.js中的payOrder方法\n\t\t\t\tapi.payOrder(this.orderNo, currentPaymentMethod)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('[API调用] 支付订单响应:', res.data);\n\t\t\t\t\t\tif (res.data.code === 200) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '支付成功',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 关闭弹窗\n\t\t\t\t\t\t\tthis.closePopup();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 检查是否需要更新购物车\n\t\t\t\t\t\t\tthis.checkAndUpdateCart();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 刷新优惠券状态\n\t\t\t\t\t\t\tthis.refreshCouponsAfterPayment();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 显示支付成功提示后跳转到订单列表页\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\t\t\turl: '/pages/order/order'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: res.data.message || '支付失败',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('[API调用] 网络请求失败:', err);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 刷新优惠券状态\n\t\t\trefreshCouponsAfterPayment() {\n\t\t\t\t// 发送请求刷新优惠券列表\n\t\t\t\tapi.refreshCoupons()\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('支付后刷新优惠券状态:', res.data);\n\t\t\t\t\t\t// 只是触发后端接口更新优惠券状态，不需要处理返回数据\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('刷新优惠券状态失败:', err);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 检查并更新购物车状态\n\t\t\tcheckAndUpdateCart() {\n\t\t\t\t// 获取购物车状态，检查是否有需要移除的商品\n\t\t\t\tapi.getCart()\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('获取购物车信息:', res.data);\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 检查是否有已选择的商品，如果有则移除\n\t\t\t\t\t\tlet hasSelectedItems = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 根据不同的响应结构处理数据\n\t\t\t\t\t\tif (res.data && res.data.code === 200 && res.data.data && res.data.data.items) {\n\t\t\t\t\t\t\thasSelectedItems = res.data.data.items.some(item => item.selected);\n\t\t\t\t\t\t} else if (Array.isArray(res.data)) {\n\t\t\t\t\t\t\thasSelectedItems = res.data.some(item => item.selected);\n\t\t\t\t\t\t} else if (res.data && res.data.items) {\n\t\t\t\t\t\t\thasSelectedItems = res.data.items.some(item => item.selected);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// 如果有选中的商品，则移除它们\n\t\t\t\t\t\tif (hasSelectedItems) {\n\t\t\t\t\t\t\tthis.clearSelectedCartItems();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('获取购物车信息失败:', err);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 清空已选中的购物车商品\n\t\t\tclearSelectedCartItems() {\n\t\t\t\tapi.clearSelectedCartItems()\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('移除已选择的购物车商品成功:', res.data);\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('移除购物车商品失败:', err);\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 选择支付方式\n\t\t\tselectPaymentMethod(method) {\n\t\t\t\tthis.paymentMethod = method;\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.detail-container {\n\t\theight: 100vh;\n\t\tbackground-color: #121212;\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\toverflow: hidden;\n\t}\n\t\n\t/* 顶部导航栏 */\n\t.navbar {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\theight: calc(90rpx + var(--status-bar-height) + 20rpx);\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 0;\n\t\tpadding-top: calc(var(--status-bar-height) + 20rpx);\n\t\tposition: relative;\n\t\tz-index: 100;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t\tjustify-content: space-between;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.back-btn {\n\t\twidth: 50rpx;\n\t\theight: 50rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 0 30rpx;\n\t}\n\t\n\t.back-icon {\n\t\twidth: 40rpx;\n\t\theight: 40rpx;\n\t}\n\t\n\t.title {\n\t\tflex: 1;\n\t\ttext-align: center;\n\t\tfont-size: 32rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.navbar-right {\n\t\twidth: 100rpx;\n\t}\n\t\n\t/* 加载中 */\n\t.loading-box {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t}\n\t\n\t.loading-spinner {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tborder: 4rpx solid #7b68ee;\n\t\tborder-top-color: transparent;\n\t\tborder-radius: 50%;\n\t\tanimation: spin 0.8s linear infinite;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t@keyframes spin {\n\t\t0% { transform: rotate(0deg); }\n\t\t100% { transform: rotate(360deg); }\n\t}\n\t\n\t.loading-text {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t/* 滚动视图 */\n\t.detail-scroll-view {\n\t\tflex: 1;\n\t\theight: 0; /* 重要: 当使用flex:1时，需要设置初始高度为0 */\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t\tpadding: 15rpx;\n\t}\n\t\n\t/* 卡片和部分样式 */\n\t.status-card,\n\t.detail-section {\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 16rpx;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 20rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t/* 底部安全区域 */\n\t.safe-area-inset-bottom {\n\t\theight: 50rpx;\n\t\twidth: 100%;\n\t}\n\t\n\t/* 订单状态卡片 */\n\t.status-card {\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 16rpx;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 20rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.status-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tmargin-bottom: 25rpx;\n\t}\n\t\n\t.status-text {\n\t\tfont-size: 32rpx;\n\t\tcolor: #7b68ee;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.order-id {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t/* 订单状态时间线 */\n\t.status-timeline {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tpadding: 15rpx 0;\n\t}\n\t\n\t.timeline-item {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tposition: relative;\n\t}\n\t\n\t.timeline-dot {\n\t\twidth: 16rpx;\n\t\theight: 16rpx;\n\t\tborder-radius: 50%;\n\t\tbackground-color: #2a2a2a;\n\t\tmargin-top: 8rpx;\n\t\tmargin-right: 16rpx;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.timeline-item.completed .timeline-dot {\n\t\tbackground-color: #7b68ee;\n\t}\n\t\n\t.timeline-line {\n\t\twidth: 4rpx;\n\t\theight: 40rpx;\n\t\tbackground-color: #2a2a2a;\n\t\tmargin-left: 6rpx;\n\t\tmargin-right: 28rpx;\n\t}\n\t\n\t.timeline-line.completed {\n\t\tbackground-color: #7b68ee;\n\t}\n\t\n\t.timeline-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t}\n\t\n\t.timeline-title {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t\tmargin-bottom: 6rpx;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t.timeline-item.completed .timeline-title {\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.timeline-time {\n\t\tfont-size: 22rpx;\n\t\tcolor: #666666;\n\t}\n\t\n\t/* 取消状态 */\n\t.status-canceled {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tpadding: 20rpx 0 10rpx;\n\t}\n\t\n\t.canceled-text {\n\t\tfont-size: 30rpx;\n\t\tcolor: #888888;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.canceled-time {\n\t\tfont-size: 22rpx;\n\t\tcolor: #666666;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t/* 退款信息 */\n\t.refund-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tbackground-color: rgba(255, 107, 107, 0.1);\n\t\tpadding: 10rpx 20rpx;\n\t\tborder-radius: 8rpx;\n\t\tmargin-top: 5rpx;\n\t\twidth: 80%;\n\t}\n\t\n\t.refund-reason {\n\t\tfont-size: 22rpx;\n\t\tcolor: #ff6b6b;\n\t\tmargin-bottom: 5rpx;\n\t}\n\t\n\t.refund-time {\n\t\tfont-size: 22rpx;\n\t\tcolor: #ff6b6b;\n\t}\n\t\n\t/* 订单详情部分 */\n\t.detail-section {\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 16rpx;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 20rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.section-title {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 15rpx;\n\t\tposition: relative;\n\t\tpadding-left: 16rpx;\n\t}\n\t\n\t.section-title::before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 6rpx;\n\t\theight: 24rpx;\n\t\twidth: 5rpx;\n\t\tbackground-color: #7b68ee;\n\t\tborder-radius: 3rpx;\n\t}\n\t\n\t/* 配送信息 */\n\t.pickup-info {\n\t\tpadding: 20rpx 0;\n\t}\n\t\n\t.pickup-item {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.pickup-value {\n\t\tcolor: #ffffff;\n\t\tfont-size: 60rpx;\n\t\tfont-weight: bold;\n\t\ttext-shadow: 0 0 8rpx rgba(123, 104, 238, 0.6);\n\t\ttext-align: center;\n\t}\n\t\n\t.pickup-note {\n\t\tfont-size: 24rpx;\n\t\tcolor: #888888;\n\t\tpadding: 10rpx 0;\n\t\ttext-align: center;\n\t}\n\t\n\t/* 商品信息 */\n\t.product-item {\n\t\tdisplay: flex;\n\t\tpadding: 12rpx 0;\n\t\tborder-bottom: 1rpx solid #2a2a2a;\n\t}\n\t\n\t.product-item:last-child {\n\t\tborder-bottom: none;\n\t}\n\t\n\t.product-image {\n\t\twidth: 90rpx;\n\t\theight: 90rpx;\n\t\tborder-radius: 8rpx;\n\t\tbackground-color: #2a2a2a;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.product-info {\n\t\tflex: 1;\n\t\tmargin-left: 12rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: space-between;\n\t\tmin-width: 0;\n\t\toverflow: hidden;\n\t}\n\t\n\t.product-name {\n\t\tfont-size: 24rpx;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 6rpx;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t.product-spec {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t\tmargin-bottom: 6rpx;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t.product-ingredients {\n\t\tfont-size: 20rpx;\n\t\tcolor: #888888;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t.product-price-qty {\n\t\tmin-width: 90rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: flex-end;\n\t\tjustify-content: center;\n\t\tflex-shrink: 0;\n\t}\n\t\n\t.product-price {\n\t\tfont-size: 24rpx;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 6rpx;\n\t}\n\t\n\t.product-qty {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t/* 订单金额 */\n\t.price-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.price-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t\n\t.price-label {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t.price-value {\n\t\tfont-size: 26rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.price-value.discount {\n\t\tcolor: #ff6b6b;\n\t}\n\t\n\t.price-item.total {\n\t\tborder-top: 1rpx solid #2a2a2a;\n\t\tpadding-top: 15rpx;\n\t\tmargin-top: 15rpx;\n\t}\n\t\n\t.price-label.total, .price-value.total {\n\t\tfont-size: 28rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t/* 支付信息 */\n\t.payment-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.payment-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t\n\t.payment-label {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t.payment-value {\n\t\tfont-size: 26rpx;\n\t\tcolor: #ffffff;\n\t\tmax-width: 60%;\n\t\ttext-align: right;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t/* 订单操作按钮 */\n\t.detail-actions {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-top: 25rpx;\n\t}\n\t\n\t.action-btn {\n\t\twidth: 47%;\n\t\theight: 70rpx;\n\t\tborder-radius: 35rpx;\n\t\tfont-size: 26rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t}\n\t\n\t.cancel-btn {\n\t\tbackground-color: transparent;\n\t\tcolor: #ffffff;\n\t\tborder: 2rpx solid #ffffff;\n\t}\n\t\n\t.pay-btn {\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t\tborder: none;\n\t}\n\t\n\t/* 支付弹窗 */\n\t.payment-popup {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tz-index: 1000;\n\t}\n\t\n\t.popup-mask {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t}\n\t\n\t.popup-content {\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 30rpx 30rpx 0 0;\n\t\toverflow: hidden;\n\t\tbox-sizing: border-box;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.popup-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 20rpx;\n\t\tborder-bottom: 1rpx solid #2a2a2a;\n\t}\n\t\n\t.popup-title {\n\t\tfont-size: 30rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.popup-close {\n\t\tfont-size: 36rpx;\n\t\tcolor: #888888;\n\t\tpadding: 0 15rpx;\n\t}\n\t\n\t.popup-body {\n\t\tpadding: 20rpx 30rpx;\n\t\tflex: 1;\n\t}\n\t\n\t.popup-footer {\n\t\tpadding: 20rpx 30rpx 40rpx 30rpx;\n\t\tborder-top: 1rpx solid #2a2a2a;\n\t}\n\t\n\t.payment-amount-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.payment-amount {\n\t\tfont-size: 50rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.payment-order-no {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t\tmax-width: 90%;\n\t\twhite-space: nowrap;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t}\n\t\n\t.payment-methods {\n\t\tmargin-bottom: 25rpx;\n\t\twidth: 100%;\n\t}\n\t\n\t.payment-method-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 25rpx 20rpx;\n\t\tborder-radius: 12rpx;\n\t\tmargin-bottom: 15rpx;\n\t\tbackground-color: #2a2a2a;\n\t\tposition: relative;\n\t\tborder: 1px solid transparent;\n\t}\n\t\n\t.payment-method-item.active {\n\t\tbackground-color: rgba(123, 104, 238, 0.1);\n\t\tborder: 1px solid #7b68ee;\n\t}\n\t\n\t.payment-method-content {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex: 1;\n\t}\n\t\n\t.payment-icon {\n\t\twidth: 50rpx;\n\t\theight: 50rpx;\n\t\tmargin-right: 20rpx;\n\t\tflex-shrink: 0;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t\n\t.payment-icon-img {\n\t\twidth: 36rpx;\n\t\theight: 36rpx;\n\t}\n\t\n\t.payment-icon-wechat {\n\t\tcolor: #09BB07;\n\t}\n\t\n\t.payment-icon-alipay {\n\t\tcolor: #1677FF;\n\t}\n\t\n\t.payment-name {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: 500;\n\t}\n\t\n\t.payment-select {\n\t\tcolor: #7b68ee;\n\t\tfont-size: 32rpx;\n\t\tmargin-right: 10rpx;\n\t}\n\t\n\t.confirm-payment-btn {\n\t\twidth: 100%;\n\t\theight: 80rpx;\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t\tborder-radius: 40rpx;\n\t\tfont-size: 28rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tborder: none;\n\t}\n\t\n\t/* 优惠券选择弹窗 */\n\t.coupon-modal {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tz-index: 1001; /* 确保优惠券弹窗在支付弹窗之上 */\n\t}\n\t\n\t.coupon-modal-mask {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t}\n\t\n\t.coupon-modal-container {\n\t\tposition: absolute;\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\tmax-height: 80vh;\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 30rpx 30rpx 0 0;\n\t\toverflow: hidden;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.coupon-modal-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 20rpx 30rpx;\n\t\tborder-bottom: 1rpx solid #2a2a2a;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.coupon-modal-title {\n\t\tfont-size: 32rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.coupon-modal-close {\n\t\tfont-size: 36rpx;\n\t\tcolor: #888888;\n\t\tpadding: 0 15rpx;\n\t}\n\t\n\t.coupon-modal-content {\n\t\tpadding: 20rpx 30rpx;\n\t\tmax-height: 60vh;\n\t\toverflow-y: auto;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.coupon-list {\n\t\tmargin-bottom: 25rpx;\n\t\twidth: 100%;\n\t}\n\t\n\t.coupon-card {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tmargin: 20rpx 0;\n\t\tpadding: 30rpx 20rpx;\n\t\tbackground: linear-gradient(135deg, #2a2a2a 0%, #222222 100%);\n\t\tborder-radius: 12rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);\n\t\toverflow: hidden;\n\t\talign-items: center;\n\t}\n\t\n\t.coupon-card::before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 10rpx;\n\t\theight: 100%;\n\t\tbackground-color: #7b68ee;\n\t\tborder-radius: 10rpx 0 0 10rpx;\n\t}\n\t\n\t.coupon-card.selected {\n\t\tbackground: linear-gradient(135deg, #332e59 0%, #1a1842 100%);\n\t\tborder: 1rpx solid #7b68ee;\n\t}\n\t\n\t.coupon-left {\n\t\tflex: 3;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\tpadding: 10rpx 20rpx;\n\t\tposition: relative;\n\t\tz-index: 1;\n\t\tmin-width: 160rpx;\n\t}\n\t\n\t.coupon-amount {\n\t\tfont-size: 40rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #7b68ee;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.coupon-condition {\n\t\tfont-size: 22rpx;\n\t\tcolor: #999999;\n\t\tmargin-top: 8rpx;\n\t\tbackground-color: rgba(123, 104, 238, 0.1);\n\t\tpadding: 6rpx 12rpx;\n\t\tborder-radius: 10rpx;\n\t\tdisplay: inline-block;\n\t\twhite-space: nowrap;\n\t}\n\t\n\t.coupon-right {\n\t\tflex: 5;\n\t\tpadding: 10rpx 20rpx;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\tz-index: 1;\n\t}\n\t\n\t.coupon-name {\n\t\tfont-size: 28rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.coupon-desc {\n\t\tfont-size: 24rpx;\n\t\tcolor: #aaaaaa;\n\t\tmargin-bottom: 8rpx;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tdisplay: -webkit-box;\n\t\t-webkit-line-clamp: 2;\n\t\t-webkit-box-orient: vertical;\n\t}\n\t\n\t.coupon-date {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t\tbackground-color: rgba(255, 255, 255, 0.05);\n\t\tpadding: 4rpx 10rpx;\n\t\tborder-radius: 8rpx;\n\t\tdisplay: inline-block;\n\t}\n\t\n\t.coupon-select-icon {\n\t\tposition: absolute;\n\t\tright: 20rpx;\n\t\ttop: 20rpx;\n\t\twidth: 40rpx;\n\t\theight: 40rpx;\n\t\tborder-radius: 50%;\n\t\tbackground-color: #7b68ee;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 2;\n\t}\n\t\n\t.check-icon {\n\t\tfont-size: 26rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.no-coupons {\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t\ttext-align: center;\n\t\tpadding: 40rpx 0;\n\t}\n\t\n\t.coupon-modal-footer {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tpadding: 30rpx;\n\t\tgap: 20rpx;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.coupon-cancel-btn,\n\t.coupon-confirm-btn {\n\t\twidth: 45%;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tborder-radius: 40rpx;\n\t\tfont-size: 28rpx;\n\t\tborder: none;\n\t}\n\t\n\t.coupon-cancel-btn {\n\t\tbackground-color: #333333;\n\t\tcolor: #aaaaaa;\n\t}\n\t\n\t.coupon-confirm-btn {\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t/* 支付弹窗中的优惠券选择 */\n\t.coupon-selection {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 20rpx 15rpx;\n\t\tborder-radius: 12rpx;\n\t\tbackground-color: #2a2a2a;\n\t\tmargin-bottom: 20rpx;\n\t\tposition: relative;\n\t}\n\t\n\t.coupon-label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.coupon-value {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.coupon-value text.discount-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ff6b6b;\n\t\tfont-weight: 500;\n\t}\n\t\n\t.coupon-value text.normal-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #7b68ee;\n\t}\n\t\n\t.coupon-arrow {\n\t\tfont-size: 28rpx;\n\t\tcolor: #888888;\n\t\tmargin-left: 10rpx;\n\t}\n\t\n\t/* 优惠明细 */\n\t.discount-detail {\n\t\tmargin-bottom: 20rpx;\n\t\tpadding: 15rpx;\n\t\tbackground-color: #222222;\n\t\tborder-radius: 10rpx;\n\t}\n\t\n\t.discount-row {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.discount-label {\n\t\tfont-size: 24rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t.discount-value {\n\t\tfont-size: 24rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.coupon-discount {\n\t\tcolor: #ff6b6b;\n\t}\n\t\n\t/* 为选中的支付方式添加特殊效果 */\n\t.payment-method-item.active .payment-name {\n\t\tcolor: #7b68ee;\n\t\tfont-weight: bold;\n\t}\n\t\n\t/* 调整各支付图标大小以适配布局 */\n\t.payment-icon svg {\n\t\twidth: 32rpx;\n\t\theight: 32rpx;\n\t}\n\t\n\t/* 根据设备尺寸自动调整支付按钮 */\n\t@media screen and (max-width: 375px) {\n\t\t.payment-method-item {\n\t\t\tpadding: 20rpx 15rpx;\n\t\t}\n\t\t\n\t\t.payment-name {\n\t\t\tfont-size: 26rpx;\n\t\t}\n\t\t\n\t\t.payment-icon svg {\n\t\t\twidth: 28rpx;\n\t\t\theight: 28rpx;\n\t\t}\n\t}\n\t\n\t.coupon-notice {\n\t\tbackground-color: #2a2a2a;\n\t\tpadding: 15rpx 20rpx;\n\t\tmargin: 15rpx 0 20rpx;\n\t\tborder-radius: 8rpx;\n\t\tborder-left: 4rpx solid #ff9800;\n\t}\n\t\n\t.coupon-notice text {\n\t\tfont-size: 24rpx;\n\t\tcolor: #ff9800;\n\t}\n</style> ","import MiniProgramPage from 'C:/Users/LXD/Desktop/奶茶点单系统/milktea-uniapp/pages/order/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api","res"],"mappings":"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"}