{"version":3,"file":"confirm.js","sources":["pages/order/confirm.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvb3JkZXIvY29uZmlybS52dWU"],"sourcesContent":["<template>\n\t<view class=\"confirm-container\">\n\t\t<view v-if=\"loading\" class=\"loading\">\n\t\t\t<text>加载中...</text>\n\t\t</view>\n\t\t\n\t\t<scroll-view v-else scroll-y class=\"confirm-content\">\n\t\t\t<!-- 商品列表 -->\n\t\t\t<view class=\"product-section\">\n\t\t\t\t<view class=\"section-title\">已选商品</view>\n\t\t\t\t<view class=\"product-list\">\n\t\t\t\t\t<view \n\t\t\t\t\t\tv-for=\"item in cartItems\" \n\t\t\t\t\t\t:key=\"item.id\" \n\t\t\t\t\t\tclass=\"product-item\">\n\t\t\t\t\t\t<image :src=\"getProductImage(item)\" mode=\"aspectFill\" class=\"product-image\"></image>\n\t\t\t\t\t\t<view class=\"product-info\">\n\t\t\t\t\t\t\t<view class=\"product-top\">\n\t\t\t\t\t\t\t\t<view class=\"product-name\">{{ getProductName(item) }}</view>\n\t\t\t\t\t\t\t\t<view class=\"product-quantity\">x{{ item.quantity || 1 }}</view>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"product-options\" v-if=\"item.temperature || item.sweetness || hasIngredients(item)\">\n\t\t\t\t\t\t\t\t<text v-if=\"item.temperature\">{{ item.temperature }}</text>\n\t\t\t\t\t\t\t\t<text v-if=\"item.sweetness\">{{ item.sweetness }}</text>\n\t\t\t\t\t\t\t\t<text v-if=\"hasIngredients(item)\">\n\t\t\t\t\t\t\t\t\t{{ formatIngredients(item) }}\n\t\t\t\t\t\t\t\t</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t<view class=\"product-price\">¥{{ calculateItemPrice(item).toFixed(2) }}</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 优惠券选择 -->\n\t\t\t<view class=\"coupon-section\" @click=\"openCouponModal\">\n\t\t\t\t<view class=\"section-title\">优惠券</view>\n\t\t\t\t<view class=\"coupon-right\">\n\t\t\t\t\t<text v-if=\"selectedCoupon\" class=\"coupon-value\">\n\t\t\t\t\t\t已选择：{{ selectedCoupon.name }} -¥{{ selectedCoupon.amount.toFixed(2) }}\n\t\t\t\t\t</text>\n\t\t\t\t\t<text v-else class=\"no-coupon\">未使用优惠券</text>\n\t\t\t\t\t<text class=\"arrow\">></text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 备注 -->\n\t\t\t<view class=\"note-section\">\n\t\t\t\t<view class=\"section-title\">备注</view>\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tv-model=\"note\" \n\t\t\t\t\tplaceholder=\"有什么特殊要求可以告诉我们哦~\" \n\t\t\t\t\tclass=\"note-input\" />\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 金额明细 -->\n\t\t\t<view class=\"price-detail\">\n\t\t\t\t<view class=\"price-row\">\n\t\t\t\t\t<text class=\"price-label\">商品金额</text>\n\t\t\t\t\t<text class=\"price-value\">¥{{ calculateTotalPrice().toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 优惠券折扣 -->\n\t\t\t\t<view class=\"price-row\" v-if=\"selectedCoupon\">\n\t\t\t\t\t<text class=\"price-label\">优惠券{{ selectedCoupon.type === 2 ? '(' + (selectedCoupon.amount * 10).toFixed(1) + '折)' : '' }}</text>\n\t\t\t\t\t<text class=\"price-value discount\">-¥{{ getCouponDiscountAmount().toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 优惠券后的金额 -->\n\t\t\t\t<view class=\"price-row\" v-if=\"selectedCoupon\">\n\t\t\t\t\t<text class=\"price-label\">优惠后金额</text>\n\t\t\t\t\t<text class=\"price-value\">¥{{ getPriceAfterCoupon().toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 会员折扣 -->\n\t\t\t\t<view class=\"price-row\" v-if=\"memberDiscount < 1\">\n\t\t\t\t\t<text class=\"price-label\">会员折扣 ({{ (memberDiscount * 10).toFixed(1) }}折)</text>\n\t\t\t\t\t<text class=\"price-value discount\">-¥{{ getMemberDiscountAmount().toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 实付金额 -->\n\t\t\t\t<view class=\"price-row\">\n\t\t\t\t\t<text class=\"price-label\">实付金额</text>\n\t\t\t\t\t<text class=\"price-value\">¥{{ calculateFinalPrice().toFixed(2) }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t\n\t\t\t<!-- 底部占位 -->\n\t\t\t<view class=\"bottom-placeholder\"></view>\n\t\t</scroll-view>\n\t\t\n\t\t<!-- 结算栏 -->\n\t\t<view class=\"checkout-bar\">\n\t\t\t<view class=\"total-section\">\n\t\t\t\t<text class=\"total-text\">总价：</text>\n\t\t\t\t<text class=\"total-price\">¥{{ calculateFinalPrice().toFixed(2) }}</text>\n\t\t\t</view>\n\t\t\t<button class=\"submit-btn\" @click=\"submitOrder\">提交订单</button>\n\t\t</view>\n\t\t\n\t\t<!-- 优惠券选择弹窗 -->\n\t\t<view class=\"coupon-modal\" v-if=\"showCouponModal\">\n\t\t\t<view class=\"coupon-modal-mask\" @click=\"closeCouponModal\"></view>\n\t\t\t<view class=\"coupon-modal-container\">\n\t\t\t\t<view class=\"coupon-modal-header\">\n\t\t\t\t\t<text class=\"coupon-modal-title\">选择优惠券</text>\n\t\t\t\t\t<text class=\"coupon-modal-close\" @click=\"closeCouponModal\">×</text>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"coupon-modal-content\">\n\t\t\t\t\t<view class=\"coupon-list\" v-if=\"availableCoupons.length > 0\">\n\t\t\t\t\t\t<!-- 不使用优惠券选项 -->\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tclass=\"coupon-card\" \n\t\t\t\t\t\t\t:class=\"{'selected': selectedCoupon === null}\"\n\t\t\t\t\t\t\t@click=\"selectNoCoupon\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"coupon-left\">\n\t\t\t\t\t\t\t\t<text class=\"coupon-amount\">不使用</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"coupon-right\">\n\t\t\t\t\t\t\t\t<text class=\"coupon-name\">不使用优惠券</text>\n\t\t\t\t\t\t\t\t<text class=\"coupon-desc\">无需使用优惠券</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"coupon-select-icon\" v-if=\"selectedCoupon === null\">\n\t\t\t\t\t\t\t\t<text class=\"check-icon\">✓</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<!-- 可用优惠券列表 -->\n\t\t\t\t\t\t<view \n\t\t\t\t\t\t\tv-for=\"(coupon, index) in availableCoupons\" \n\t\t\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t\t\tclass=\"coupon-card\" \n\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t'selected': selectedCoupon && selectedCoupon.id === coupon.id,\n\t\t\t\t\t\t\t\t'disabled': !coupon.canUse\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t@click=\"coupon.canUse ? selectCoupon(coupon) : showMinAmountTips(coupon)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<view class=\"coupon-left\">\n\t\t\t\t\t\t\t\t<text class=\"coupon-amount\" v-if=\"coupon.type === 1\">¥{{ coupon.amount.toFixed(2) }}</text>\n\t\t\t\t\t\t\t\t<text class=\"coupon-amount\" v-else>{{ (coupon.amount * 10).toFixed(1) }}折</text>\n\t\t\t\t\t\t\t\t<text class=\"coupon-condition\" v-if=\"coupon.minConsumption > 0\" :class=\"{'condition-not-met': !coupon.canUse}\">满{{ coupon.minConsumption.toFixed(2) }}可用</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"coupon-right\">\n\t\t\t\t\t\t\t\t<text class=\"coupon-name\">{{ coupon.name }}</text>\n\t\t\t\t\t\t\t\t<text class=\"coupon-desc\">{{ coupon.description || coupon.typeText }}</text>\n\t\t\t\t\t\t\t\t<text class=\"coupon-date\">有效期至{{ coupon.expireDate }}</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"coupon-select-icon\" v-if=\"selectedCoupon && selectedCoupon.id === coupon.id\">\n\t\t\t\t\t\t\t\t<text class=\"check-icon\">✓</text>\n\t\t\t\t\t\t\t</view>\n\t\t\t\t\t\t\t<view class=\"coupon-disabled-mask\" v-if=\"!coupon.canUse\"></view>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t\n\t\t\t\t\t<view class=\"no-coupons\" v-else>\n\t\t\t\t\t\t<text>暂无可用优惠券</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"coupon-modal-footer\">\n\t\t\t\t\t<button class=\"cancel-btn\" @click=\"closeCouponModal\">取消</button>\n\t\t\t\t\t<button class=\"confirm-btn\" @click=\"confirmCouponSelection\">确定</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport api from '@/utils/api.js';\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tcartItems: [],\n\t\t\t\tloading: true,\n\t\t\t\tavailableCoupons: [],\n\t\t\t\tselectedCoupon: null,\n\t\t\t\tpaymentMethod: 'wechat',\n\t\t\t\tpaymentMethods: [\n\t\t\t\t\t{ name: '微信支付', value: 'wechat', icon: 'weixin' },\n\t\t\t\t\t{ name: '支付宝', value: 'alipay', icon: 'zhifubao' },\n\t\t\t\t\t{ name: '积分支付', value: 'point', icon: 'jifen' }\n\t\t\t\t],\n\t\t\t\tnote: '',\n\t\t\t\tdeliveryFee: 0, // 店内点餐无配送费\n\t\t\t\tshowCouponModal: false,\n\t\t\t\t\n\t\t\t\t// 会员信息相关\n\t\t\t\tmemberInfo: null,\n\t\t\t\tmemberDiscount: 1.0 // 默认不打折\n\t\t\t}\n\t\t},\n\t\tonLoad(options) {\n\t\t\t\n\t\t\t// 获取会员信息和折扣\n\t\t\tthis.getMemberInfo();\n\t\t\t\n\t\t\t// 检查是否有从外部传入的商品数据\n\t\t\tif (options && options.items) {\n\t\t\t\ttry {\n\t\t\t\t\t// 尝试解析传入的商品数据\n\t\t\t\t\tconst passedItems = JSON.parse(decodeURIComponent(options.items));\n\t\t\t\t\tif (passedItems && Array.isArray(passedItems) && passedItems.length > 0) {\n\t\t\t\t\t\tthis.cartItems = passedItems;\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('解析传入商品数据失败:', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t// 如果没有成功从外部获取数据，则从API获取购物车商品\n\t\t\tif (!this.cartItems || this.cartItems.length === 0) {\n\t\t\t\tthis.loadCartItems();\n\t\t\t}\n\t\t\t\n\t\t\t// 无论如何都获取可用优惠券\n\t\t\tthis.loadUserCoupons();\n\t\t},\n\t\tmethods: {\n\t\t\t// 加载购物车数据\n\t\t\tloadCartItems() {\n\t\t\t\tthis.loading = true;\n\t\t\t\t\n\t\t\t\tapi.request({\n\t\t\t\t\turl: '/cart',\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.statusCode === 200) {\n\t\t\t\t\t\t\t// 处理不同的数据结构\n\t\t\t\t\t\t\tif (res.data.code === 200 && res.data.data) {\n\t\t\t\t\t\t\t\t// 处理 {code:200, data:{items:[...]}} 的结构\n\t\t\t\t\t\t\t\tconst cartData = res.data.data;\n\t\t\t\t\t\t\t// 只获取已选中的商品\n\t\t\t\t\t\t\t\tthis.cartItems = cartData.items ? cartData.items.filter(item => item.selected) : [];\n\t\t\t\t\t\t\t} else if (Array.isArray(res.data)) {\n\t\t\t\t\t\t\t\t// 处理直接返回数组 [...] 的结构\n\t\t\t\t\t\t\tthis.cartItems = res.data.filter(item => item.selected);\n\t\t\t\t\t\t\t} else if (res.data.items && Array.isArray(res.data.items)) {\n\t\t\t\t\t\t\t\t// 处理 {items:[...]} 的结构\n\t\t\t\t\t\t\t\tthis.cartItems = res.data.items.filter(item => item.selected);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 如果没有选中商品，返回购物车页面\n\t\t\t\t\t\t\tif (this.cartItems.length === 0) {\n\t\t\t\t\t\t\t\tuni.showModal({\n\t\t\t\t\t\t\t\t\ttitle: '提示',\n\t\t\t\t\t\t\t\t\tcontent: '请先选择商品后再结算',\n\t\t\t\t\t\t\t\t\tshowCancel: false,\n\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (res.statusCode === 401 || (res.data && res.data.code === 401)) {\n\t\t\t\t\t\t\t// 处理认证失败\n\t\t\t\t\t\t\tuni.removeStorageSync('token');\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '登录已过期，请重新登录',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 处理其他错误\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: res.data.message || '获取购物车失败',\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t\tconsole.error('获取购物车失败', err);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '网络请求失败',\n\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 加载用户优惠券\n\t\t\tloadUserCoupons() {\n\t\t\t\tconst token = uni.getStorageSync('token');\n\t\t\t\tif (!token) {\n\t\t\t\t\tconsole.log('未找到token，无法获取优惠券');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 获取当前订单总金额用于判断优惠券是否可用\n\t\t\t\tconst totalPrice = this.calculateTotalPrice();\n\t\t\t\t\n\t\t\t\t// 使用api.js的方法\n\t\t\t\tapi.getCoupons(0) // status=0表示未使用的优惠券\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.statusCode === 200) {\n\t\t\t\t\t\t\tlet couponsData = [];\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 直接处理标准响应结构\n\t\t\t\t\t\t\tif (res.data && res.data.code === 200 && res.data.data && res.data.data.content) {\n\t\t\t\t\t\t\t\t// 正确处理分页数据结构\n\t\t\t\t\t\t\t\tcouponsData = res.data.data.content;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.availableCoupons = [];\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (couponsData.length === 0) {\n\t\t\t\t\t\t\t\tthis.availableCoupons = [];\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 处理优惠券数据...\n\t\t\t\t\t\t\tlet processedCoupons = couponsData.map(item => {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 根据接口文档，优惠券的详细信息在coupon属性中\n\t\t\t\t\t\t\t\tconst coupon = item.coupon || item;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 尝试从不同的可能字段名获取最低消费金额\n\t\t\t\t\t\t\t\tconst minConsumption = parseFloat(\n\t\t\t\t\t\t\t\t\tcoupon.minConsumption || \n\t\t\t\t\t\t\t\t\tcoupon.minPoint || \n\t\t\t\t\t\t\t\t\tcoupon.min_point || \n\t\t\t\t\t\t\t\t\tcoupon.minAmount || \n\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 确定优惠券类型\n\t\t\t\t\t\t\t\tconst type = parseInt(coupon.type || 1);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 优惠券金额/折扣率\n\t\t\t\t\t\t\t\tconst amount = parseFloat(coupon.amount || 0);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 判断是否可用 - 优先使用API的canUse，否则判断订单金额\n\t\t\t\t\t\t\t\tlet canUse = typeof item.canUse !== 'undefined' ? item.canUse : (totalPrice >= minConsumption);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 规范化优惠券数据\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tid: item.id || coupon.id || '',\n\t\t\t\t\t\t\t\t\tcouponId: coupon.id || '',\n\t\t\t\t\t\t\t\t\tname: coupon.name || '优惠券',\n\t\t\t\t\t\t\t\t\tamount: amount,\n\t\t\t\t\t\t\t\t\ttype: type, // 1: 满减券, 2: 折扣券\n\t\t\t\t\t\t\t\t\ttypeText: coupon.typeText || (type === 2 ? '折扣券' : '满减券'),\n\t\t\t\t\t\t\t\t\tdescription: coupon.description || '',\n\t\t\t\t\t\t\t\t\tminConsumption: minConsumption,\n\t\t\t\t\t\t\t\t\tstartTime: coupon.startTime || '',\n\t\t\t\t\t\t\t\t\tendTime: coupon.endTime || '',\n\t\t\t\t\t\t\t\t\texpireDate: coupon.endTime || '',\n\t\t\t\t\t\t\t\t\tstatus: item.status || 0,\n\t\t\t\t\t\t\t\t\tstatusText: item.statusText || '未使用',\n\t\t\t\t\t\t\t\t\tcanUse: canUse\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 过滤和排序优惠券...\n\t\t\t\t\t\t\tthis.availableCoupons = processedCoupons.filter(coupon => \n\t\t\t\t\t\t\t\tcoupon.status === 0 || coupon.statusText === '未使用'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 先展示可用的再展示不可用的\n\t\t\t\t\t\t\tthis.availableCoupons.sort((a, b) => {\n\t\t\t\t\t\t\t\t// 先按照可用状态排序（可用的在前）\n\t\t\t\t\t\t\t\tif (a.canUse !== b.canUse) {\n\t\t\t\t\t\t\t\t\treturn a.canUse ? -1 : 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 对于可用的优惠券，折扣券和满减券按照折扣额度排序\n\t\t\t\t\t\t\t\tif (a.canUse) {\n\t\t\t\t\t\t\t\t\t// 计算实际折扣金额用于排序\n\t\t\t\t\t\t\t\t\tconst aValue = a.type === 2 ? totalPrice * (1 - a.amount) : a.amount;\n\t\t\t\t\t\t\t\t\tconst bValue = b.type === 2 ? totalPrice * (1 - b.amount) : b.amount;\n\t\t\t\t\t\t\t\t\treturn bValue - aValue; // 折扣大的优先\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 不可用的按照最低消费金额排序\n\t\t\t\t\t\t\t\treturn a.minConsumption - b.minConsumption;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.availableCoupons = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('获取优惠券请求失败，错误详情:', err);\n\t\t\t\t\t\tthis.availableCoupons = [];\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 选择优惠券\n\t\t\topenCouponModal() {\n\t\t\t\tthis.showCouponModal = true;\n\t\t\t},\n\t\t\t\n\t\t\t// 关闭优惠券选择弹窗\n\t\t\tcloseCouponModal() {\n\t\t\t\tthis.showCouponModal = false;\n\t\t\t},\n\t\t\t\n\t\t\t// 选择优惠券\n\t\t\tselectCoupon(coupon) {\n\t\t\t\t// 检查优惠券是否满足使用条件\n\t\t\t\tif (!coupon.canUse) {\n\t\t\t\t\tthis.showMinAmountTips(coupon);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.selectedCoupon = coupon;\n\t\t\t\tthis.showCouponModal = false;\n\t\t\t},\n\t\t\t\n\t\t\t// 选择不使用优惠券\n\t\t\tselectNoCoupon() {\n\t\t\t\t\t\t\tthis.selectedCoupon = null;\n\t\t\t\tthis.showCouponModal = false;\n\t\t\t},\n\t\t\t\n\t\t\t// 确认优惠券选择\n\t\t\tconfirmCouponSelection() {\n\t\t\t\tthis.showCouponModal = false;\n\t\t\t},\n\t\t\t\n\t\t\t// 选择支付方式\n\t\t\tselectPayment(method) {\n\t\t\t\tthis.paymentMethod = method;\n\t\t\t},\n\t\t\t\n\t\t\t// 计算单个商品价格\n\t\t\tcalculateItemPrice(item) {\n\t\t\t\tconsole.log('计算商品价格:', item);\n\t\t\t\t\n\t\t\t\t// 防止item为undefined\n\t\t\t\tif (!item) {\n\t\t\t\t\tconsole.error('商品数据为空');\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tlet price = 0;\n\t\t\t\t\n\t\t\t\t// 尝试从不同数据结构中获取价格\n\t\t\t\tif (item.product && typeof item.product.price !== 'undefined') {\n\t\t\t\t\tprice = item.product.price;\n\t\t\t\t} else if (typeof item.productPrice !== 'undefined') {\n\t\t\t\t\tprice = item.productPrice;\n\t\t\t\t} else if (typeof item.price !== 'undefined') {\n\t\t\t\t\tprice = item.price;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 确保价格是数字类型\n\t\t\t\tprice = parseFloat(price) || 0;\n\t\t\t\t\n\t\t\t\t// 计算配料额外价格\n\t\t\t\tif (item.ingredients && item.ingredients.length > 0) {\n\t\t\t\t\tconst ingredientsPrice = item.ingredients.reduce((sum, ing) => {\n\t\t\t\t\t\tconst ingPrice = parseFloat(ing.price) || 0;\n\t\t\t\t\t\treturn sum + ingPrice;\n\t\t\t\t\t}, 0);\n\t\t\t\t\t\n\t\t\t\t\tprice += ingredientsPrice;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst quantity = parseInt(item.quantity) || 1;\n\t\t\t\tconst totalPrice = price * quantity;\n\t\t\t\t\n\t\t\t\treturn totalPrice;\n\t\t\t},\n\t\t\t\n\t\t\t// 计算商品总价\n\t\t\tcalculateTotalPrice() {\n\t\t\t\treturn this.cartItems.reduce((sum, item) => sum + this.calculateItemPrice(item), 0);\n\t\t\t},\n\t\t\t\n\t\t\t// 计算最终价格（含优惠）\n\t\t\tcalculateFinalPrice() {\n\t\t\t\t// 计算商品总价\n\t\t\t\tlet total = this.calculateTotalPrice();\n\t\t\t\t\n\t\t\t\t// 先应用优惠券\n\t\t\t\tif (this.selectedCoupon) {\n\t\t\t\t\tif (this.selectedCoupon.type === 2) { // 折扣券\n\t\t\t\t\t\t// 折扣券金额是折扣率，如0.8表示8折\n\t\t\t\t\t\tconst discountRate = this.selectedCoupon.amount;\n\t\t\t\t\t\t// 计算折扣金额\n\t\t\t\t\t\tconst discountAmount = total * (1 - discountRate);\n\t\t\t\t\t\ttotal = total - discountAmount;\n\t\t\t\t\t} else { // 满减券\n\t\t\t\t\t\ttotal = Math.max(0, total - this.selectedCoupon.amount);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 然后对剩余金额应用会员折扣\n\t\t\t\tif (this.memberDiscount < 1) {\n\t\t\t\t\tconst beforeDiscount = total;\n\t\t\t\t\t// 四舍五入保留两位小数\n\t\t\t\t\ttotal = Math.round(total * this.memberDiscount * 100) / 100;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn total > 0 ? total : 0;\n\t\t\t},\n\t\t\t\n\t\t\t// 获取优惠券折扣金额方法\n\t\t\tgetCouponDiscountAmount() {\n\t\t\t\tif (!this.selectedCoupon) return 0;\n\t\t\t\t\n\t\t\t\tconst totalPrice = this.calculateTotalPrice();\n\t\t\t\t\n\t\t\t\tif (this.selectedCoupon.type === 2) { // 折扣券\n\t\t\t\t\t// 折扣券折扣金额 = 原价 × (1 - 折扣率)\n\t\t\t\t\treturn totalPrice * (1 - this.selectedCoupon.amount);\n\t\t\t\t} else { // 满减券\n\t\t\t\t\treturn this.selectedCoupon.amount;\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 获取会员折扣金额方法\n\t\t\tgetMemberDiscountAmount() {\n\t\t\t\tif (this.memberDiscount >= 1) return 0;\n\t\t\t\t\n\t\t\t\t// 先计算应用优惠券后的金额\n\t\t\t\tlet priceAfterCoupon = this.getPriceAfterCoupon();\n\t\t\t\t\n\t\t\t\t// 会员折扣金额 = 优惠券后金额 × (1 - 会员折扣率)\n\t\t\t\tlet discountAmount = priceAfterCoupon * (1 - this.memberDiscount);\n\t\t\t\t\n\t\t\t\t// 舍入到两位小数\n\t\t\t\tdiscountAmount = Math.round(discountAmount * 100) / 100;\n\t\t\t\t\n\t\t\t\treturn discountAmount;\n\t\t\t},\n\t\t\t\n\t\t\t// 获取优惠券后金额方法\n\t\t\tgetPriceAfterCoupon() {\n\t\t\t\tconst totalPrice = this.calculateTotalPrice();\n\t\t\t\t\n\t\t\t\tif (!this.selectedCoupon) return totalPrice;\n\t\t\t\t\n\t\t\t\tif (this.selectedCoupon.type === 2) { // 折扣券\n\t\t\t\t\treturn totalPrice * this.selectedCoupon.amount;\n\t\t\t\t} else { // 满减券\n\t\t\t\t\treturn Math.max(0, totalPrice - this.selectedCoupon.amount);\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 提交订单\n\t\t\tsubmitOrder() {\n\t\t\t\tif (this.cartItems.length === 0) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '请先选择商品',\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tuni.showLoading({\n\t\t\t\t\ttitle: '提交中...'\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// 构建符合API格式的订单数据\n\t\t\t\tconst orderData = {\n\t\t\t\t\t// 购物车商品ID列表\n\t\t\t\t\tcartIds: this.cartItems.map(item => item.id || 0).filter(id => id > 0),\n\t\t\t\t\t\n\t\t\t\t\t// 直接购买的商品信息（如果有）\n\t\t\t\t\tdirectProduct: this.cartItems.length === 1 && this.cartItems[0].directBuy ? {\n\t\t\t\t\t\tproductId: this.cartItems[0].productId || this.cartItems[0].product?.id,\n\t\t\t\t\t\tquantity: this.cartItems[0].quantity || 1,\n\t\t\t\t\t\tcartId: this.cartItems[0].id || 0,\n\t\t\t\t\t\ttemperature: this.cartItems[0].temperature || \"\",\n\t\t\t\t\t\tsweetness: this.cartItems[0].sweetness || \"\",\n\t\t\t\t\t\tingredients: (this.cartItems[0].ingredients || []).map(ing => ({\n\t\t\t\t\t\t\tid: ing.id || 0,\n\t\t\t\t\t\t\tname: ing.name || \"\",\n\t\t\t\t\t\t\tprice: ing.price || 0\n\t\t\t\t\t\t})),\n\t\t\t\t\t\tselected: true\n\t\t\t\t\t} : null,\n\t\t\t\t\t\n\t\t\t\t\t// 备注/说明\n\t\t\t\t\tremark: this.note || \"\",\n\t\t\t\t\t\n\t\t\t\t\t// 优惠券ID\n\t\t\t\t\tuserCouponId: this.selectedCoupon ? (this.selectedCoupon.id || 0) : null\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t// 如果没有直接购买商品，则移除该字段\n\t\t\t\tif (!orderData.directProduct) {\n\t\t\t\t\tdelete orderData.directProduct;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 如果没有选择优惠券，则移除该字段\n\t\t\t\tif (!orderData.userCouponId) {\n\t\t\t\t\tdelete orderData.userCouponId;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tconst token = uni.getStorageSync('token');\n\t\t\t\tif (!token) {\n\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// 使用api.js的createOrder方法\n\t\t\t\tapi.createOrder(orderData)\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.statusCode === 200 || res.statusCode === 201) {\n\t\t\t\t\t\t\t// 获取订单ID和订单号\n\t\t\t\t\t\t\tlet orderId, orderNo;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (res.data && res.data.code === 200 && res.data.data) {\n\t\t\t\t\t\t\t\t// 标准API响应结构\n\t\t\t\t\t\t\t\torderId = res.data.data.id || res.data.data.orderId;\n\t\t\t\t\t\t\t\torderNo = res.data.data.orderNo;\n\t\t\t\t\t\t\t} else if (res.data) {\n\t\t\t\t\t\t\t\t// 备用结构\n\t\t\t\t\t\t\t\torderId = res.data.orderId || res.data.id;\n\t\t\t\t\t\t\t\torderNo = res.data.orderNo;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (orderId || orderNo) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '订单提交成功',\n\t\t\t\t\t\t\t\t\ticon: 'success',\n\t\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 清空已选中的购物车商品\n\t\t\t\t\t\t\t\tif (this.cartItems.length > 0) {\n\t\t\t\t\t\t\t\t\tthis.clearSelectedCartItems();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t// 跳转到订单详情页面\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\t\t\turl: `/pages/order/detail?orderNo=${orderNo || orderId}`\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '订单数据异常',\n\t\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tconsole.error('订单创建成功但返回数据异常', res.data);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 显示错误信息\n\t\t\t\t\t\t\tlet errorMsg = '创建订单失败';\n\t\t\t\t\t\t\tif (res.data && res.data.message) {\n\t\t\t\t\t\t\t\terrorMsg = res.data.message;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: errorMsg,\n\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconsole.error('创建订单失败:', res);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tuni.hideLoading();\n\t\t\t\t\t\tconsole.error('提交订单失败:', err);\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '网络请求失败，请稍后再试',\n\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\tduration: 2000\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 清空已选中的购物车商品\n\t\t\tclearSelectedCartItems() {\n\t\t\t\tconst token = uni.getStorageSync('token');\n\t\t\t\tif (!token) return;\n\t\t\t\t\n\t\t\t\t// 发送请求移除购物车中已选择的商品\n\t\t\t\tapi.request({\n\t\t\t\t\turl: '/cart/selected',\n\t\t\t\t\tmethod: 'DELETE',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tconsole.log('移除已选择的购物车商品成功:', res.data);\n\t\t\t\t\t},\n\t\t\t\t\tfail: (err) => {\n\t\t\t\t\t\tconsole.error('移除购物车商品失败:', err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 获取商品图片\n\t\t\tgetProductImage(item) {\n\t\t\t\tif (item.product && item.product.image) {\n\t\t\t\t\treturn item.product.image;\n\t\t\t\t} else if (item.productImage) {\n\t\t\t\t\treturn item.productImage;\n\t\t\t\t}\n\t\t\t\treturn '/static/default-product.png';\n\t\t\t},\n\t\t\t\n\t\t\t// 获取商品名称\n\t\t\tgetProductName(item) {\n\t\t\t\tif (item.product && item.product.name) {\n\t\t\t\t\treturn item.product.name;\n\t\t\t\t} else if (item.productName) {\n\t\t\t\t\treturn item.productName;\n\t\t\t\t}\n\t\t\t\treturn '未知商品';\n\t\t\t},\n\t\t\t\n\t\t\t// 检查是否有配料\n\t\t\thasIngredients(item) {\n\t\t\t\treturn item.ingredients && item.ingredients.length > 0;\n\t\t\t},\n\t\t\t\n\t\t\t// 格式化配料显示\n\t\t\tformatIngredients(item) {\n\t\t\t\tif (!this.hasIngredients(item)) return '';\n\t\t\t\t\n\t\t\t\treturn item.ingredients.map(ing => {\n\t\t\t\t\treturn ing.name || ing;\n\t\t\t\t}).join('、');\n\t\t\t},\n\t\t\t\n\t\t\t// 显示未满足最低金额的提示\n\t\t\tshowMinAmountTips(coupon) {\n\t\t\t\tconst diff = coupon.minConsumption - this.calculateTotalPrice();\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: `还差¥${diff.toFixed(2)}才能使用此${coupon.type === 2 ? '折扣' : ''}优惠券`,\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 2000\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 获取会员等级信息\n\t\t\tgetMemberInfo() {\n\t\t\t\tconst token = uni.getStorageSync('token');\n\t\t\t\tif (!token) return;\n\t\t\t\t\n\t\t\t\t// 使用api.js的getMemberInfo方法\n\t\t\t\tapi.getMemberInfo()\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconsole.log('获取会员信息响应状态码:', res.statusCode);\n\t\t\t\t\t\tconsole.log('获取会员信息完整响应:', JSON.stringify(res.data));\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (res.statusCode === 200 && res.data && res.data.code === 200) {\n\t\t\t\t\t\t\tthis.memberInfo = res.data.data;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 设置会员折扣\n\t\t\t\t\t\t\tif (this.memberInfo && this.memberInfo.discount) {\n\t\t\t\t\t\t\t\tthis.memberDiscount = parseFloat(this.memberInfo.discount);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.error('获取会员信息失败:', res.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tconsole.error('获取会员信息请求失败:', err);\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t/* 整体容器 */\n\t.confirm-container {\n\t\theight: 100vh;\n\t\tbackground-color: #121212;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.confirm-content {\n\t\tflex: 1;\n\t\theight: calc(100vh - 120rpx); /* 减去结算栏高度 */\n\t\toverflow-y: auto;\n\t}\n\t\n\t.loading {\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\theight: 100vh;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.section-title {\n\t\tfont-size: 28rpx;\n\t\tcolor: #888888;\n\t}\n\t\n\t.arrow {\n\t\tfont-size: 30rpx;\n\t\tcolor: #666666;\n\t}\n\t\n\t/* 商品列表 */\n\t.product-section {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\tmargin: 20rpx;\n\t}\n\t\n\t.product-list {\n\t\tmargin-top: 20rpx;\n\t}\n\t\n\t.product-item {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 20rpx 0;\n\t\tborder-bottom: 1rpx solid #333333;\n\t}\n\t\n\t.product-item:last-child {\n\t\tborder-bottom: none;\n\t}\n\t\n\t.product-image {\n\t\twidth: 120rpx;\n\t\theight: 120rpx;\n\t\tborder-radius: 8rpx;\n\t\tmargin-right: 20rpx;\n\t\tbackground-color: #2a2a2a;\n\t}\n\t\n\t.product-info {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.product-top {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.product-name {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.product-quantity {\n\t\tfont-size: 28rpx;\n\t\tcolor: #999999;\n\t}\n\t\n\t.product-options {\n\t\tfont-size: 24rpx;\n\t\tcolor: #888888;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.product-options text {\n\t\tmargin-right: 20rpx;\n\t}\n\t\n\t.product-price {\n\t\tfont-size: 28rpx;\n\t\tcolor: #7b68ee;\n\t}\n\t\n\t/* 优惠券 */\n\t.coupon-section {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tborder-radius: 16rpx;\n\t\tmargin: 20rpx;\n\t}\n\t\n\t.coupon-right {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.coupon-value {\n\t\tfont-size: 28rpx;\n\t\tcolor: #7b68ee;\n\t\tmargin-right: 10rpx;\n\t}\n\t\n\t.no-coupon {\n\t\tfont-size: 28rpx;\n\t\tcolor: #999999;\n\t\tmargin-right: 10rpx;\n\t}\n\t\n\t/* 支付方式 */\n\t.payment-section {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\tmargin: 20rpx;\n\t}\n\t\n\t.payment-methods {\n\t\tdisplay: flex;\n\t\tmargin-top: 20rpx;\n\t}\n\t\n\t.payment-method {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tpadding: 20rpx;\n\t\tborder-radius: 8rpx;\n\t\tborder: 2rpx solid transparent;\n\t\tbackground-color: #2a2a2a;\n\t\tmargin: 0 10rpx;\n\t}\n\t\n\t.payment-method:first-child {\n\t\tmargin-left: 0;\n\t}\n\t\n\t.payment-method:last-child {\n\t\tmargin-right: 0;\n\t}\n\t\n\t.payment-method.selected {\n\t\tborder-color: #7b68ee;\n\t\tbackground-color: rgba(123, 104, 238, 0.1);\n\t}\n\t\n\t.payment-icon {\n\t\theight: 60rpx;\n\t\tmargin-bottom: 10rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\t\n\t.payment-icon .icon {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t}\n\t\n\t.payment-name {\n\t\tfont-size: 26rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t/* 备注 */\n\t.note-section {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\tmargin: 20rpx;\n\t}\n\t\n\t.note-input {\n\t\tmargin-top: 20rpx;\n\t\theight: 80rpx;\n\t\tborder: 1rpx solid #333333;\n\t\tborder-radius: 8rpx;\n\t\tpadding: 0 20rpx;\n\t\tfont-size: 28rpx;\n\t\tbackground-color: #2a2a2a;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t/* 金额明细 */\n\t.price-detail {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tmargin-bottom: 20rpx;\n\t\tborder-radius: 16rpx;\n\t\tmargin: 20rpx;\n\t}\n\t\n\t.price-row {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.price-row:last-child {\n\t\tmargin-bottom: 0;\n\t}\n\t\n\t.price-label {\n\t\tfont-size: 28rpx;\n\t\tcolor: #999999;\n\t}\n\t\n\t.price-value {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.discount {\n\t\tcolor: #7b68ee;\n\t}\n\t\n\t/* 底部占位，确保内容不被结算栏遮挡 */\n\t.bottom-placeholder {\n\t\theight: 120rpx;\n\t}\n\t\n\t/* 结算栏 */\n\t.checkout-bar {\n\t\tposition: fixed;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\theight: 120rpx;\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 20rpx 30rpx;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tbox-shadow: 0 -2rpx 10rpx rgba(0, 0, 0, 0.3);\n\t\tz-index: 100;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.total-section {\n\t\tflex: 1; /* 让总价部分占据剩余空间 */\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\t\n\t.total-text {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.total-price {\n\t\tfont-size: 36rpx;\n\t\tcolor: #7b68ee;\n\t\tfont-weight: bold;\n\t}\n\t\n\t.submit-btn {\n\t\twidth: 240rpx;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t\tborder-radius: 40rpx;\n\t\tfont-size: 30rpx;\n\t\tmargin-left: auto; /* 确保按钮靠右 */\n\t}\n\t\n\t/* 优惠券选择弹窗 */\n\t.coupon-modal {\n\t\tposition: fixed;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 1000;\n\t}\n\t\n\t.coupon-modal-mask {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\t\n\t.coupon-modal-container {\n\t\tbackground-color: #1a1a1a;\n\t\tpadding: 30rpx;\n\t\tborder-radius: 16rpx;\n\t\twidth: 90%;\n\t\tmax-width: 650rpx;\n\t\tmax-height: 80vh;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t}\n\t\n\t.coupon-modal-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.coupon-modal-title {\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.coupon-modal-close {\n\t\tfont-size: 30rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.coupon-modal-content {\n\t\tflex: 1;\n\t\tmax-height: 60vh;\n\t\toverflow-y: auto;\n\t}\n\t\n\t.coupon-list {\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t/* 优惠券卡片样式 - 仅应用于弹窗内 */\n\t.coupon-modal .coupon-card {\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tmargin: 20rpx 0;\n\t\tpadding: 30rpx 20rpx;\n\t\tbackground: linear-gradient(135deg, #2a2a2a 0%, #222222 100%);\n\t\tborder-radius: 12rpx;\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.2);\n\t\toverflow: hidden;\n\t\talign-items: center;\n\t}\n\t\n\t.coupon-modal .coupon-card::before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tleft: 0;\n\t\ttop: 0;\n\t\twidth: 10rpx;\n\t\theight: 100%;\n\t\tbackground-color: #7b68ee;\n\t\tborder-radius: 10rpx 0 0 10rpx;\n\t}\n\t\n\t.coupon-modal .coupon-card::after {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\tright: 25%;\n\t\ttop: 0;\n\t\twidth: 2rpx;\n\t\theight: 100%;\n\t\tbackground-image: linear-gradient(to bottom, #333333 0%, #333333 50%, transparent 50%);\n\t\tbackground-size: 2rpx 12rpx;\n\t\tbackground-repeat: repeat-y;\n\t}\n\t\n\t.coupon-modal .coupon-card.selected {\n\t\tbackground: linear-gradient(135deg, #332e59 0%, #1a1842 100%);\n\t\tborder: 1rpx solid #7b68ee;\n\t}\n\t\n\t/* 不可用优惠券样式 */\n\t.coupon-modal .coupon-card.disabled {\n\t\topacity: 0.7;\n\t\tbackground: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 100%);\n\t}\n\t\n\t.coupon-modal .coupon-card.disabled::before {\n\t\tbackground-color: #555555;\n\t}\n\t\n\t.coupon-disabled-mask {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tbackground-color: rgba(0, 0, 0, 0.3);\n\t\tz-index: 3;\n\t}\n\t\n\t.condition-not-met {\n\t\tcolor: #ff6b6b !important;\n\t\tbackground-color: rgba(255, 107, 107, 0.1) !important;\n\t}\n\t\n\t.coupon-modal .coupon-left {\n\t\tflex: 3;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\tpadding: 10rpx 20rpx;\n\t\tposition: relative;\n\t\tz-index: 1;\n\t\tmin-width: 160rpx;\n\t}\n\t\n\t.coupon-modal .coupon-amount {\n\t\tfont-size: 40rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #7b68ee;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.coupon-modal .coupon-condition {\n\t\tfont-size: 22rpx;\n\t\tcolor: #999999;\n\t\tmargin-top: 8rpx;\n\t\tbackground-color: rgba(123, 104, 238, 0.1);\n\t\tpadding: 6rpx 12rpx;\n\t\tborder-radius: 10rpx;\n\t\tdisplay: inline-block;\n\t\twhite-space: nowrap;\n\t}\n\t\n\t.coupon-modal .coupon-right {\n\t\tflex: 6;\n\t\tpadding: 10rpx 20rpx 10rpx 40rpx;\n\t\tborder-left: none;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tjustify-content: center;\n\t\tz-index: 1;\n\t}\n\t\n\t.coupon-modal .coupon-name {\n\t\tfont-size: 28rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 8rpx;\n\t}\n\t\n\t.coupon-modal .coupon-desc {\n\t\tfont-size: 24rpx;\n\t\tcolor: #aaaaaa;\n\t\tmargin-bottom: 8rpx;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\tdisplay: -webkit-box;\n\t\t-webkit-line-clamp: 2;\n\t\t-webkit-box-orient: vertical;\n\t}\n\t\n\t.coupon-modal .coupon-date {\n\t\tfont-size: 22rpx;\n\t\tcolor: #888888;\n\t\tbackground-color: rgba(255, 255, 255, 0.05);\n\t\tpadding: 4rpx 10rpx;\n\t\tborder-radius: 8rpx;\n\t\tdisplay: inline-block;\n\t}\n\t\n\t.coupon-select-icon {\n\t\tposition: absolute;\n\t\tright: 20rpx;\n\t\ttop: 20rpx;\n\t\twidth: 40rpx;\n\t\theight: 40rpx;\n\t\tborder-radius: 50%;\n\t\tbackground-color: #7b68ee;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tz-index: 2;\n\t}\n\t\n\t.check-icon {\n\t\tfont-size: 26rpx;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.coupon-modal-footer {\n\t\ttext-align: right;\n\t\tmargin-top: 20rpx;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\tpadding: 0 20rpx;\n\t}\n\t\n\t.cancel-btn {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tbackground-color: #333333;\n\t\tcolor: #aaaaaa;\n\t\tborder-radius: 40rpx;\n\t\tfont-size: 28rpx;\n\t\tmargin-right: 20rpx;\n\t\tmax-width: 220rpx;\n\t}\n\t\n\t.confirm-btn {\n\t\tflex: 1;\n\t\theight: 80rpx;\n\t\tline-height: 80rpx;\n\t\ttext-align: center;\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t\tborder-radius: 40rpx;\n\t\tfont-size: 28rpx;\n\t\tmax-width: 220rpx;\n\t}\n\t\n\t.no-coupons {\n\t\ttext-align: center;\n\t\tpadding: 20rpx;\n\t\tcolor: #999999;\n\t}\n\t\n\t/* 引入字体图标 */\n\t@font-face {\n\t\tfont-family: 'iconfont';\n\t\tsrc: url('https://at.alicdn.com/t/font_3094924_eoqn9nhzl6.woff2') format('woff2'),\n\t\t\t url('https://at.alicdn.com/t/font_3094924_eoqn9nhzl6.woff') format('woff'),\n\t\t\t url('https://at.alicdn.com/t/font_3094924_eoqn9nhzl6.ttf') format('truetype');\n\t}\n\t\n\t.iconfont {\n\t\tfont-family: \"iconfont\" !important;\n\t\tfont-size: 48rpx;\n\t\tfont-style: normal;\n\t\t-webkit-font-smoothing: antialiased;\n\t\t-moz-osx-font-smoothing: grayscale;\n\t}\n\t\n\t.icon-wechat:before {\n\t\tcontent: \"\\e63b\";\n\t\tcolor: #07C160;\n\t}\n\t\n\t.icon-alipay:before {\n\t\tcontent: \"\\e618\";\n\t\tcolor: #1677FF;\n\t}\n\t\n\t.icon-point:before {\n\t\tcontent: \"\\e657\";\n\t\tcolor: #FF6B00;\n\t}\n</style> ","import MiniProgramPage from 'C:/Users/LXD/Desktop/奶茶点单系统/milktea-uniapp/pages/order/confirm.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api"],"mappings":"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"}