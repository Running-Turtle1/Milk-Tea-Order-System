{"version":3,"file":"member-center.js","sources":["pages/user/member-center.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9tZW1iZXItY2VudGVyLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-wrapper\">\n    <scroll-view scroll-y class=\"member-center\" :style=\"{ height: scrollHeight + 'px' }\">\n      <!-- 会员信息头部 -->\n      <view class=\"member-header\">\n        <view class=\"header-bg\"></view>\n        <view class=\"member-info\">\n          <image :src=\"userInfo.avatar || '/static/tabbar/user.png'\" class=\"avatar\" mode=\"aspectFill\"></image>\n          <view class=\"info-content\">\n            <view class=\"username\">{{userInfo.username}}</view>\n            <view class=\"member-level\">\n              <text class=\"level-name\">{{memberInfo.levelName || '普通会员'}}</text>\n              <text class=\"level-desc\">{{memberInfo.benefits || ''}}</text>\n              <text class=\"discount-badge\" v-if=\"memberInfo.discount && memberInfo.discount < 1\">{{(memberInfo.discount * 10).toFixed(1)}}折</text>\n            </view>\n          </view>\n        </view>\n        \n        <!-- 会员等级按钮 -->\n        <view class=\"point-rules-btn\" @click=\"toggleMemberLevelModal\">\n          <text class=\"point-rules-text\">会员等级</text>\n          <text class=\"point-rules-icon\">?</text>\n        </view>\n      </view>\n      \n      <!-- 会员数据卡片 -->\n      <view class=\"data-card\">\n        <view class=\"data-item\">\n          <text class=\"data-value\">{{userInfo.totalPoints || memberInfo.currentPoints || 0}}</text>\n          <text class=\"data-label\">我的积分</text>\n        </view>\n        <view class=\"divider\"></view>\n        <view class=\"data-item\">\n          <text class=\"data-value\">{{getUnusedCouponCount()}}</text>\n          <text class=\"data-label\">可用优惠券</text>\n        </view>\n        <view class=\"divider\"></view>\n        <view class=\"data-item\">\n          <text class=\"data-value\">{{memberInfo.pointsToNextLevel || 0}}</text>\n          <text class=\"data-label\">升级还需</text>\n        </view>\n      </view>\n      \n      <!-- 签到模块 -->\n      <view class=\"section checkin-section\">\n        <view class=\"section-header\">\n          <text class=\"section-title\">每日签到</text>\n          <text class=\"section-subtitle\">已连续签到 {{checkinInfo.continuesDays || 0}} 天</text>\n        </view>\n        <view class=\"checkin-calendar\">\n          <view class=\"calendar-header\">\n            <text>{{currentYear}}年{{currentMonth}}月</text>\n          </view>\n          <view class=\"calendar-days\">\n            <view class=\"weekday-row\">\n              <text v-for=\"(day, index) in ['日','一','二','三','四','五','六']\" :key=\"index\" class=\"weekday\">{{day}}</text>\n            </view>\n            <view class=\"days-grid\">\n              <view v-for=\"(day, index) in calendarDays\" :key=\"index\" class=\"calendar-day\" \n                    :class=\"{\n                      'empty': !day,\n                      'checked': checkinInfo.days && checkinInfo.days.includes(day), \n                      'today': isToday(day)\n                    }\">\n                <text v-if=\"day\">{{day}}</text>\n              </view>\n            </view>\n          </view>\n        </view>\n        <button class=\"checkin-btn\" \n                :class=\"{'checked': todayChecked}\" \n                :disabled=\"todayChecked\"\n                @click=\"handleCheckin\">\n          {{todayChecked ? '今日已签到' : '立即签到'}}\n        </button>\n      </view>\n      \n      <!-- 积分和优惠券标签栏 -->\n      <view class=\"tab-container\">\n        <view class=\"tab-header\">\n          <view class=\"tab-item\" \n                :class=\"{'active': activeTab === 0}\" \n                @click=\"activeTab = 0\">\n            积分记录\n            <text class=\"point-rules-icon\" @click.stop=\"togglePointRules\">?</text>\n          </view>\n          <view class=\"tab-item\" \n                :class=\"{'active': activeTab === 1}\" \n                @click=\"activeTab = 1\">我的优惠券\n          </view>\n          <view class=\"tab-item\" \n                :class=\"{'active': activeTab === 2}\" \n                @click=\"activeTab = 2\">可领优惠券</view>\n        </view>\n        \n        <!-- 积分记录 -->\n        <scroll-view v-if=\"activeTab === 0\" \n                    scroll-y \n                    class=\"tab-content points-record\"\n                    @scrolltolower=\"handlePointsScrollToLower\">\n          <view class=\"empty-tip\" v-if=\"pointRecords.length === 0 && !loadingPoints\">\n            <text>暂无积分记录</text>\n          </view>\n          <view v-else class=\"record-list\">\n            <view class=\"record-item\" v-for=\"record in pointRecords\" :key=\"record.id\">\n              <view class=\"record-info\">\n                <text class=\"record-desc\">{{record.description}}</text>\n                <text class=\"record-time\">{{record.createdAt}}</text>\n              </view>\n              <text :class=\"['record-points', record.point > 0 ? 'positive' : 'negative']\">\n                {{record.point > 0 ? '+' : ''}}{{record.point}}\n              </text>\n            </view>\n            <!-- 加载状态显示 -->\n            <view class=\"loading-more\" v-if=\"loadingPoints\">\n              <view class=\"loading-spinner\"></view>\n              <text>加载中...</text>\n            </view>\n            <!-- 已加载全部 -->\n            <view class=\"no-more\" v-if=\"!hasMorePointRecords && pointRecords.length > 0\">\n              <text>— 已加载全部 —</text>\n            </view>\n          </view>\n        </scroll-view>\n        \n        <!-- 我的优惠券 -->\n        <scroll-view v-if=\"activeTab === 1\" scroll-y class=\"tab-content my-coupons\">\n          <view class=\"empty-tip\" v-if=\"coupons.length === 0\">\n            <text v-if=\"loadingCoupons\">加载中...</text>\n            <text v-else>暂无优惠券</text>\n          </view>\n          <view v-else class=\"coupon-list\">\n            <view class=\"coupon-item\" v-for=\"item in coupons\" :key=\"item.id\"\n                  :class=\"{\n                    'used': item.status === 1,\n                    'expired': item.status === 2\n                  }\">\n              <view class=\"coupon-left\">\n                <view class=\"coupon-amount\">\n                  <text class=\"amount-prefix\" v-if=\"item.coupon && item.coupon.type === 1\">¥</text>\n                  <text class=\"amount-value\">{{formatAmount(item.coupon)}}</text>\n                  <text class=\"amount-postfix\" v-if=\"item.coupon && item.coupon.type === 2\">折</text>\n                </view>\n                <text class=\"condition\" v-if=\"item.coupon && item.coupon.minConsumption > 0\">满{{item.coupon.minConsumption}}元可用</text>\n              </view>\n              <view class=\"coupon-right\">\n                <text class=\"coupon-name\">{{item.coupon ? item.coupon.name : '优惠券'}}</text>\n                <text class=\"coupon-time\">{{formatDate(item.coupon ? item.coupon.startTime : '')}} - {{formatDate(item.coupon ? item.coupon.endTime : '')}}</text>\n                <text class=\"coupon-status\">\n                  {{item.statusText || getCouponStatusText(item.status)}}\n                </text>\n              </view>\n              <view class=\"debug-info\" v-if=\"debugMode\">\n                <text>原始数据: {{JSON.stringify(item)}}</text>\n              </view>\n            </view>\n          </view>\n          <view class=\"load-more\" v-if=\"hasMoreCoupons && !loadingCoupons\" @click=\"loadMoreCoupons\">\n            加载更多\n          </view>\n          <view class=\"loading\" v-if=\"loadingCoupons\">加载中...</view>\n        </scroll-view>\n        \n        <!-- 可领优惠券 -->\n        <scroll-view v-if=\"activeTab === 2\" scroll-y class=\"tab-content receivable-coupons\">\n          <view class=\"empty-tip\" v-if=\"receivableCoupons.length === 0\">\n            <text>暂无可领取的优惠券</text>\n          </view>\n          <view v-else class=\"coupon-list\">\n            <view class=\"coupon-item receivable\" v-for=\"coupon in receivableCoupons\" :key=\"coupon.id\">\n              <view class=\"coupon-left\">\n                <view class=\"coupon-amount\">\n                  <text class=\"amount-prefix\" v-if=\"coupon.type === 1\">¥</text>\n                  <text class=\"amount-value\">{{formatAmount(coupon)}}</text>\n                  <text class=\"amount-postfix\" v-if=\"coupon.type === 2\">折</text>\n                </view>\n                <text class=\"condition\" v-if=\"coupon.minConsumption > 0\">满{{coupon.minConsumption}}元可用</text>\n              </view>\n              <view class=\"coupon-right\">\n                <text class=\"coupon-name\">{{coupon.name || '优惠券'}}</text>\n                <text class=\"coupon-time\">{{formatDate(coupon.startTime)}} - {{formatDate(coupon.endTime)}}</text>\n                <button class=\"receive-btn\" @click.stop=\"receiveCoupon(coupon.id)\">领取</button>\n              </view>\n              <view class=\"debug-info\" v-if=\"debugMode\">\n                <text>原始数据: {{JSON.stringify(coupon)}}</text>\n              </view>\n            </view>\n          </view>\n        </scroll-view>\n      </view>\n    </scroll-view>\n    \n    <!-- 会员等级说明弹窗 -->\n    <view class=\"member-level-modal\" v-if=\"showMemberLevelModal\">\n      <view class=\"modal-mask\" @click=\"toggleMemberLevelModal\"></view>\n      <view class=\"modal-content\">\n        <view class=\"modal-header\">\n          <text class=\"modal-title\">会员等级与权益</text>\n          <text class=\"modal-close\" @click=\"toggleMemberLevelModal\">×</text>\n        </view>\n        <view class=\"modal-body\">\n          <view class=\"level-item\" v-for=\"(level, index) in memberLevelList\" :key=\"index\"\n                :class=\"{'current-level': level.level === memberInfo.currentLevel}\">\n            <view class=\"level-header\">\n              <view class=\"level-name\">\n                <text>{{level.name}}</text>\n                <text class=\"level-tag\" v-if=\"level.level === memberInfo.currentLevel\">当前等级</text>\n              </view>\n              <view class=\"level-points\">所需积分: {{level.pointThreshold}}+</view>\n            </view>\n            <view class=\"level-benefits\">\n              <view class=\"level-discount\">\n                <text class=\"benefit-label\">折扣权益:</text>\n                <text class=\"benefit-value\">{{ level.discount == 1.0 ? '无折扣' : (level.discount * 10).toFixed(1) + '折' }}</text>\n              </view>\n              <view class=\"level-other-benefits\">\n                <text class=\"benefit-label\">其他权益:</text>\n                <text class=\"benefit-value\">{{level.benefits || '无特殊权益'}}</text>\n              </view>\n            </view>\n          </view>\n          <view class=\"empty-tip\" v-if=\"memberLevelList.length === 0\">\n            <text>暂无会员等级信息</text>\n          </view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 积分规则弹窗 -->\n    <view class=\"point-rules-modal\" v-if=\"showPointRules\">\n      <view class=\"modal-mask\" @click=\"togglePointRules\"></view>\n      <view class=\"modal-content\">\n        <view class=\"modal-header\">\n          <text class=\"modal-title\">积分获取规则</text>\n          <text class=\"modal-close\" @click=\"togglePointRules\">×</text>\n        </view>\n        <view class=\"modal-body\">\n          <view class=\"rule-item\" v-for=\"(rule, index) in pointRules\" :key=\"index\">\n            <view class=\"rule-name\">{{rule.name}}</view>\n            <view class=\"rule-desc\">{{rule.description}}</view>\n            <view class=\"rule-value\" v-if=\"rule.isRatio\">\n              比例：{{rule.pointValue * 100}}%\n            </view>\n            <view class=\"rule-value\" v-else>\n              固定积分：{{rule.pointValue}}分\n            </view>\n          </view>\n          <view class=\"empty-tip\" v-if=\"pointRules.length === 0\">\n            <text>暂无积分规则</text>\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport api from '@/utils/api.js';\n\nexport default {\n  data() {\n    const now = new Date();\n    return {\n      userInfo: {},\n      memberInfo: {\n        currentLevel: 0,\n        levelName: '普通会员',\n        currentPoints: 0,\n        nextLevelPoints: 1000,\n        pointsToNextLevel: 1000,\n        discount: 1.0,\n        benefits: '无折扣'\n      },\n      \n      // 会员等级列表\n      memberLevelList: [],\n      showMemberLevelModal: false,\n      \n      // 积分记录\n      pointRecords: [],\n      pointPage: 0,\n      pointSize: 10,\n      hasMorePointRecords: true,\n      loadingPoints: false,\n      \n      // 优惠券\n      coupons: [],\n      couponPage: 0,\n      couponSize: 10,\n      hasMoreCoupons: true,\n      loadingCoupons: false,\n      \n      // 可领取的优惠券\n      receivableCoupons: [],\n      \n      // 签到相关\n      checkinInfo: {\n        days: [],\n        continuesDays: 0,\n        currentMonthDays: 30\n      },\n      currentYear: now.getFullYear(),\n      currentMonth: now.getMonth() + 1,\n      todayChecked: false,\n      calendarDays: [],\n      \n      // 选项卡\n      activeTab: 0,\n      \n      // 调试模式\n      debugMode: false,\n      \n      // 积分规则相关\n      pointRules: [],\n      showPointRules: false,\n      \n      // 页面高度\n      scrollHeight: 0\n    };\n  },\n  onLoad() {\n    this.getUserInfo();\n    this.getMemberLevel();\n    this.getPointRecords();\n    this.getCoupons();\n    this.getReceivableCoupons();\n    this.getCheckinRecords();\n    this.generateCalendar();\n    this.getPointRules();\n    this.getMemberLevelList();\n    this.setScrollHeight();\n  },\n  onPullDownRefresh() {\n    // 刷新数据\n    this.getUserInfo();\n    this.getMemberLevel();\n    this.getPointRecords();\n    this.getCoupons();\n    this.getReceivableCoupons();\n    this.getCheckinRecords();\n    \n    // 完成后停止下拉刷新\n    setTimeout(() => {\n      uni.stopPullDownRefresh();\n    }, 1000);\n  },\n  onReady() {\n    // 在页面渲染完成后再次获取高度，确保准确\n    this.setScrollHeight();\n  },\n  onShow() {\n    // 每次页面显示时更新高度\n    this.setScrollHeight();\n  },\n  // 监听窗口尺寸变化\n  onResize() {\n    this.setScrollHeight();\n  },\n  computed: {\n    isToday() {\n      const today = new Date();\n      const currentDay = today.getDate();\n      return (day) => day === currentDay && \n             this.currentMonth === (today.getMonth() + 1) && \n             this.currentYear === today.getFullYear();\n    }\n  },\n  methods: {\n    // 设置滚动区域高度\n    setScrollHeight() {\n      const that = this;\n      uni.getSystemInfo({\n        success: function(res) {\n          // 设置滚动视图高度为屏幕高度\n          that.scrollHeight = res.windowHeight;\n          console.log('设置滚动区域高度:', that.scrollHeight);\n        }\n      });\n    },\n    // 获取用户信息\n    async getUserInfo() {\n      try {\n        const res = await api.getUserInfo();\n        if (res.data && res.data.code === 200) {\n          this.userInfo = res.data.data;\n        }\n      } catch (error) {\n        console.error('获取用户信息失败', error);\n        uni.showToast({\n          title: '获取用户信息失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取会员等级信息\n    async getMemberLevel() {\n      try {\n        const res = await api.request({\n          url: '/user/member-level',\n          method: 'GET'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          this.memberInfo = res.data.data;\n          \n          // 不需要计算nextLevelPoints，直接使用响应中的值\n        }\n      } catch (error) {\n        console.error('获取会员等级信息失败', error);\n      }\n    },\n    \n    // 处理积分记录滚动到底部\n    handlePointsScrollToLower() {\n      console.log('积分记录滚动到底部');\n      if (this.hasMorePointRecords && !this.loadingPoints) {\n        this.loadMorePointRecords();\n      }\n    },\n    \n    // 获取积分记录\n    async getPointRecords(loadMore = false) {\n      if (this.loadingPoints) return;\n      \n      try {\n        this.loadingPoints = true;\n        \n        if (loadMore) {\n          this.pointPage++;\n        } else {\n          this.pointPage = 0;\n          this.pointRecords = [];\n        }\n        \n        const res = await api.request({\n          url: '/user/point-records',\n          method: 'GET',\n          data: {\n            page: this.pointPage,\n            size: this.pointSize\n          }\n        });\n        \n        if (res.data && res.data.code === 200) {\n          const data = res.data.data;\n          \n          if (loadMore) {\n            this.pointRecords = [...this.pointRecords, ...data.content];\n          } else {\n            this.pointRecords = data.content;\n          }\n          \n          this.hasMorePointRecords = this.pointRecords.length < data.totalElements;\n          console.log('积分记录加载完成，是否还有更多:', this.hasMorePointRecords);\n        }\n      } catch (error) {\n        console.error('获取积分记录失败', error);\n        uni.showToast({\n          title: '获取积分记录失败',\n          icon: 'none'\n        });\n      } finally {\n        this.loadingPoints = false;\n      }\n    },\n    \n    // 加载更多积分记录\n    loadMorePointRecords() {\n      if (this.hasMorePointRecords && !this.loadingPoints) {\n        console.log('加载更多积分记录，当前页:', this.pointPage);\n        this.getPointRecords(true);\n      }\n    },\n    \n    // 获取优惠券\n    async getCoupons(loadMore = false) {\n      if (this.loadingCoupons) return;\n      \n      try {\n        this.loadingCoupons = true;\n        \n        if (loadMore) {\n          this.couponPage++;\n        } else {\n          this.couponPage = 0;\n          this.coupons = [];\n        }\n        \n        const res = await api.request({\n          url: '/user/coupons',\n          method: 'GET',\n          data: {\n            page: this.couponPage,\n            size: this.couponSize\n          }\n        });\n        \n        if (res.data && res.data.code === 200) {\n          const data = res.data.data;\n          \n          // 确保返回数据是分页格式\n          if (data && data.content) {\n            if (loadMore) {\n              this.coupons = [...this.coupons, ...data.content];\n            } else {\n              this.coupons = data.content;\n            }\n            \n            this.hasMoreCoupons = this.coupons.length < data.totalElements;\n          } else {\n            // 如果不是分页格式，可能是直接返回的数组\n            const couponsArray = Array.isArray(data) ? data : [];\n            \n            if (loadMore) {\n              this.coupons = [...this.coupons, ...couponsArray];\n            } else {\n              this.coupons = couponsArray;\n            }\n            \n            this.hasMoreCoupons = false;\n          }\n          \n          // 排序优惠券：未使用 > 已使用 > 已过期\n          this.coupons.sort((a, b) => {\n            // 首先按状态排序\n            if (a.status !== b.status) {\n              return a.status - b.status; // 0(未使用) < 1(已使用) < 2(已过期)\n            }\n            \n            // 如果状态相同，对于未使用的优惠券，按有效期结束时间从近到远排序\n            if (a.status === 0) {\n              const aEndTime = a.coupon ? new Date(a.coupon.endTime).getTime() : 0;\n              const bEndTime = b.coupon ? new Date(b.coupon.endTime).getTime() : 0;\n              return aEndTime - bEndTime; // 越早到期的越靠前\n            }\n            \n            // 其他情况按创建时间从新到旧排序\n            const aTime = new Date(a.createdAt).getTime();\n            const bTime = new Date(b.createdAt).getTime();\n            return bTime - aTime;\n          });\n        }\n      } catch (error) {\n        console.error('获取优惠券失败', error);\n        uni.showToast({\n          title: '获取优惠券失败',\n          icon: 'none'\n        });\n      } finally {\n        this.loadingCoupons = false;\n      }\n    },\n    \n    // 加载更多优惠券\n    loadMoreCoupons() {\n      if (this.hasMoreCoupons && !this.loadingCoupons) {\n        this.getCoupons(true);\n      }\n    },\n    \n    // 获取可领取的优惠券\n    async getReceivableCoupons() {\n      try {\n        const res = await api.request({\n          url: '/user/receivable-coupons',\n          method: 'GET'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          this.receivableCoupons = Array.isArray(res.data.data) ? res.data.data : [];\n          \n          // 可领取优惠券按有效期结束时间从近到远排序\n          this.receivableCoupons.sort((a, b) => {\n            const aEndTime = a.endTime ? new Date(a.endTime).getTime() : 0;\n            const bEndTime = b.endTime ? new Date(b.endTime).getTime() : 0;\n            return aEndTime - bEndTime; // 越早到期的越靠前\n          });\n        }\n      } catch (error) {\n        console.error('获取可领取优惠券失败', error);\n        uni.showToast({\n          title: '获取可领取优惠券失败',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 领取优惠券\n    async receiveCoupon(couponId) {\n      try {\n        const res = await api.request({\n          url: `/user/receive-coupon/${couponId}`,\n          method: 'POST'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          uni.showToast({\n            title: '领取成功',\n            icon: 'success'\n          });\n          \n          // 刷新可领取的优惠券列表和我的优惠券\n          this.getReceivableCoupons();\n          this.getCoupons();\n        }\n      } catch (error) {\n        console.error('领取优惠券失败', error);\n        uni.showToast({\n          title: '领取失败，请稍后再试',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取签到记录\n    async getCheckinRecords() {\n      try {\n        const res = await api.request({\n          url: '/member/checkin/records',\n          method: 'GET',\n          data: {\n            year: this.currentYear,\n            month: this.currentMonth\n          }\n        });\n        \n        if (res.data && res.data.code === 200) {\n          this.checkinInfo = res.data.data;\n          \n          const today = new Date().getDate();\n          this.todayChecked = this.checkinInfo.days && this.checkinInfo.days.includes(today);\n        }\n      } catch (error) {\n        console.error('获取签到记录失败', error);\n      }\n    },\n    \n    // 生成日历数据\n    generateCalendar() {\n      const firstDay = new Date(this.currentYear, this.currentMonth - 1, 1).getDay();\n      const daysInMonth = new Date(this.currentYear, this.currentMonth, 0).getDate();\n      \n      // 创建一个包含当月所有日期的数组，并在前面填充空值\n      this.calendarDays = Array(firstDay).fill(null);\n      \n      for (let i = 1; i <= daysInMonth; i++) {\n        this.calendarDays.push(i);\n      }\n      \n      // 确保日历总格子数为42（6行7列）\n      const paddingDays = 42 - this.calendarDays.length;\n      if (paddingDays > 0) {\n        this.calendarDays = [...this.calendarDays, ...Array(paddingDays).fill(null)];\n      }\n    },\n    \n    // 用户签到\n    async handleCheckin() {\n      if (this.todayChecked) return;\n      \n      try {\n        const res = await api.request({\n          url: '/member/checkin',\n          method: 'POST'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          const data = res.data.data;\n          \n          uni.showToast({\n            title: `签到成功，获得${data.points}积分`,\n            icon: 'success'\n          });\n          \n          this.todayChecked = true;\n          \n          // 增加连续签到天数显示\n          if (this.checkinInfo.continuesDays) {\n            this.checkinInfo.continuesDays += 1;\n          }\n          \n          // 添加今天的日期到已签到日期中\n          const today = new Date().getDate();\n          if (this.checkinInfo.days && !this.checkinInfo.days.includes(today)) {\n            this.checkinInfo.days.push(today);\n          }\n          \n          // 更新签到信息和用户积分\n          this.getUserInfo();\n          this.getPointRecords();\n        }\n      } catch (error) {\n        console.error('签到失败', error);\n        uni.showToast({\n          title: '签到失败，请稍后再试',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 格式化日期\n    formatDate(dateString) {\n      if (!dateString) return '';\n      \n      // 检查是否包含时间\n      if (dateString.includes(':')) {\n        // 如果有时间，只返回日期部分\n        return dateString.split(' ')[0];\n      }\n      return dateString;\n    },\n    \n    // 格式化优惠券金额展示\n    formatAmount(coupon) {\n      if (!coupon) return '0';\n      \n      try {\n        // 根据类型判断如何显示金额\n        if (coupon.type === 1) { // 满减券 - 显示整数金额\n          // 检查amount是否为数字或可以转为数字的字符串\n          const amount = Number(coupon.amount);\n          return !isNaN(amount) ? amount.toFixed(0) : '0';\n        } else if (coupon.type === 2) { // 折扣券 - 显示折扣值\n          // 检查是否已经是折扣格式（小于10的数）\n          const amount = Number(coupon.amount);\n          if (!isNaN(amount)) {\n            // 如果小于1，说明是小数表示法（如0.8表示8折）\n            if (amount < 1) {\n              return (amount * 10).toFixed(1);\n            } else {\n              // 否则可能是整数表示法（如8表示8折）\n              return amount.toFixed(1);\n            }\n          }\n          return '0.0';\n        } else {\n          // 未知类型，尝试直接显示金额\n          const amount = Number(coupon.amount);\n          return !isNaN(amount) ? amount.toFixed(1) : '0';\n        }\n      } catch (e) {\n        console.error('格式化金额出错', e, coupon);\n        return '0';\n      }\n    },\n    \n    // 获取优惠券状态文本\n    getCouponStatusText(status) {\n      switch (status) {\n        case 0: \n          return '可使用';\n        case 1: \n          return '已使用';\n        case 2: \n          return '已过期';\n        default: \n          return '未知状态';\n      }\n    },\n    \n    // 切换调试模式\n    toggleDebug() {\n      this.debugMode = !this.debugMode;\n      if (this.debugMode) {\n        uni.showToast({\n          title: '已开启调试模式',\n          icon: 'none'\n        });\n      }\n    },\n    \n    // 获取未使用的优惠券数量\n    getUnusedCouponCount() {\n      if (!this.coupons || !this.coupons.length) {\n        return 0;\n      }\n      \n      // 统计状态为0（未使用）的优惠券数量\n      return this.coupons.filter(coupon => coupon.status === 0).length;\n    },\n    \n    // 获取积分规则\n    async getPointRules() {\n      try {\n        const res = await api.request({\n          url: '/member/point-rules',\n          method: 'GET'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          this.pointRules = res.data.data || [];\n        }\n      } catch (error) {\n        console.error('获取积分规则失败', error);\n      }\n    },\n    \n    // 显示积分规则弹窗\n    togglePointRules() {\n      this.showPointRules = !this.showPointRules;\n    },\n    \n    // 获取会员等级列表\n    async getMemberLevelList() {\n      try {\n        const res = await api.request({\n          url: '/member/levels',\n          method: 'GET'\n        });\n        \n        if (res.data && res.data.code === 200) {\n          this.memberLevelList = res.data.data || [];\n          console.log('会员等级列表:', this.memberLevelList);\n        }\n      } catch (error) {\n        console.error('获取会员等级列表失败', error);\n      }\n    },\n    \n    // 显示会员等级弹窗\n    toggleMemberLevelModal() {\n      this.showMemberLevelModal = !this.showMemberLevelModal;\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.page-wrapper {\n  position: relative;\n  width: 100%;\n  height: 100vh;\n  overflow: hidden;\n  background-color: #111111;\n}\n\n.member-center {\n  width: 100%;\n  height: 100%;\n  background-color: #111111;\n  padding-bottom: 30rpx;\n  \n  .member-header {\n    background-color: #222222;\n    padding-bottom: 20rpx;\n    position: relative;\n    \n    .header-bg {\n      height: 200rpx;\n      background: linear-gradient(45deg, #7b68ee, #9370db);\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      opacity: 0.8;\n      z-index: 0;\n    }\n    \n    .member-info {\n      display: flex;\n      align-items: center;\n      padding: 30rpx 20rpx;\n      position: relative;\n      z-index: 1;\n      \n      .avatar {\n        width: 120rpx;\n        height: 120rpx;\n        border-radius: 50%;\n        border: 4rpx solid rgba(255,255,255,0.2);\n        margin-right: 20rpx;\n      }\n      \n      .info-content {\n        flex: 1;\n        \n        .username {\n          font-size: 32rpx;\n          color: #ffffff;\n          margin-bottom: 10rpx;\n          font-weight: bold;\n        }\n        \n        .member-level {\n          display: flex;\n          align-items: center;\n          flex-wrap: wrap;\n          \n          .level-name {\n            font-size: 26rpx;\n            color: #ffffff;\n            padding: 4rpx 12rpx;\n            background-color: rgba(15, 1, 95, 0.2);\n            border-radius: 20rpx;\n            margin-right: 16rpx;\n          }\n          \n          .level-desc {\n            font-size: 24rpx;\n            color: #e7e7e7;\n            margin-right: 16rpx;\n          }\n          \n          .discount-badge {\n            font-size: 22rpx;\n            color: #ffffff;\n            background-color: #7b68ee;\n            padding: 4rpx 12rpx;\n            border-radius: 20rpx;\n            margin-left: 16rpx;\n          }\n        }\n      }\n    }\n    \n    .point-rules-btn {\n      position: absolute;\n      top: 30rpx;\n      right: 20rpx;\n      z-index: 2;\n      display: flex;\n      align-items: center;\n      padding: 6rpx 16rpx;\n      background-color: rgba(0,0,0,0.3);\n      border-radius: 30rpx;\n      \n      .point-rules-text {\n        font-size: 24rpx;\n        color: #ffffff;\n        margin-right: 8rpx;\n      }\n      \n      .point-rules-icon {\n        font-size: 20rpx;\n        width: 24rpx;\n        height: 24rpx;\n        line-height: 24rpx;\n        text-align: center;\n        border-radius: 50%;\n        border: 1rpx solid #ffffff;\n        color: #ffffff;\n      }\n    }\n  }\n  \n  .data-card {\n    position: relative;\n    z-index: 3;\n    margin: -40rpx 30rpx 0;\n    background-color: #1a1a1a;\n    border-radius: 16rpx;\n    box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.3);\n    display: flex;\n    padding: 30rpx 0;\n    \n    .data-item {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      \n      .data-value {\n        font-size: 36rpx;\n        font-weight: bold;\n        color: #fff;\n        margin-bottom: 10rpx;\n      }\n      \n      .data-label {\n        font-size: 24rpx;\n        color: #aaa;\n      }\n    }\n    \n    .divider {\n      width: 2rpx;\n      background-color: #333;\n      margin: 0 10rpx;\n    }\n  }\n  \n  .section {\n    margin: 30rpx;\n    background-color: #1a1a1a;\n    border-radius: 16rpx;\n    overflow: hidden;\n    box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.2);\n    \n    .section-header {\n      padding: 24rpx 30rpx;\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      border-bottom: 2rpx solid #333;\n      \n      .section-title {\n        font-size: 30rpx;\n        font-weight: bold;\n        color: #fff;\n      }\n      \n      .section-subtitle {\n        font-size: 24rpx;\n        color: #aaa;\n      }\n    }\n  }\n  \n  .checkin-section {\n    .checkin-calendar {\n      padding: 20rpx 30rpx;\n      \n      .calendar-header {\n        text-align: center;\n        margin-bottom: 20rpx;\n        font-size: 28rpx;\n        color: #fff;\n      }\n      \n      .weekday-row {\n        display: flex;\n        justify-content: space-around;\n        margin-bottom: 10rpx;\n        \n        .weekday {\n          flex: 1;\n          text-align: center;\n          font-size: 24rpx;\n          color: #999;\n        }\n      }\n      \n      .days-grid {\n        display: flex;\n        flex-wrap: wrap;\n        \n        .calendar-day {\n          width: 14.28%;\n          height: 70rpx;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          font-size: 26rpx;\n          color: #ddd;\n          position: relative;\n          \n          &.empty {\n            background: none;\n          }\n          \n          &.checked {\n            color: #7b68ee;\n            font-weight: bold;\n          }\n          \n          &.today {\n            color: #7b68ee;\n            font-weight: bold;\n            position: relative;\n            \n            &::after {\n              content: '';\n              position: absolute;\n              top: 50%;\n              left: 50%;\n              transform: translate(-50%, -50%);\n              width: 50rpx;\n              height: 50rpx;\n              border-radius: 50%;\n              background-color: #7b68ee;\n              opacity: 0.2;\n              z-index: 0;\n            }\n          }\n        }\n      }\n    }\n    \n    .checkin-btn {\n      margin: 20rpx 30rpx 30rpx;\n      height: 80rpx;\n      line-height: 80rpx;\n      text-align: center;\n      background-color: #7b68ee;\n      color: #fff;\n      font-size: 28rpx;\n      border-radius: 40rpx;\n      \n      &.checked {\n        background-color: #444;\n      }\n    }\n  }\n  \n  .tab-container {\n    margin: 30rpx;\n    background-color: #1a1a1a;\n    border-radius: 16rpx;\n    overflow: hidden;\n    box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.2);\n    position: relative;\n    \n    .tab-header {\n      display: flex;\n      border-bottom: 1rpx solid #333333;\n      \n      .tab-item {\n        flex: 1;\n        text-align: center;\n        padding: 20rpx 0;\n        font-size: 28rpx;\n        color: #999999;\n        position: relative;\n        \n        .point-rules-icon {\n          display: inline-block;\n          margin-left: 6rpx;\n          font-size: 24rpx;\n          color: #888888;\n          width: 24rpx;\n          height: 24rpx;\n          line-height: 24rpx;\n          text-align: center;\n          border-radius: 50%;\n          border: 1rpx solid #888888;\n        }\n        \n        &.active {\n          color: #7b68ee;\n          font-weight: bold;\n          \n          &::after {\n            content: '';\n            position: absolute;\n            bottom: 0;\n            left: 50%;\n            transform: translateX(-50%);\n            width: 40rpx;\n            height: 4rpx;\n            background-color: #7b68ee;\n            border-radius: 2rpx;\n          }\n        }\n      }\n    }\n    \n    .tab-content {\n      max-height: 600rpx;\n    }\n    \n    .empty-tip {\n      padding: 100rpx 0;\n      text-align: center;\n      color: #999;\n      font-size: 26rpx;\n    }\n    \n    .load-more {\n      text-align: center;\n      padding: 20rpx 0;\n      font-size: 24rpx;\n      color: #7b68ee;\n    }\n    \n    .loading {\n      text-align: center;\n      padding: 20rpx 0;\n      font-size: 24rpx;\n      color: #999;\n    }\n    \n    .loading-more {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      padding: 20rpx 0;\n      \n      .loading-spinner {\n        width: 30rpx;\n        height: 30rpx;\n        margin-right: 10rpx;\n        border: 3rpx solid #7b68ee;\n        border-radius: 50%;\n        border-top-color: transparent;\n        animation: spin 0.8s linear infinite;\n      }\n      \n      text {\n        font-size: 24rpx;\n        color: #999;\n      }\n    }\n    \n    .no-more {\n      text-align: center;\n      padding: 20rpx 0;\n      font-size: 24rpx;\n      color: #666;\n    }\n    \n    @keyframes spin {\n      to { transform: rotate(360deg); }\n    }\n    \n    .points-record {\n      .record-list {\n        padding: 10rpx 30rpx;\n        \n        .record-item {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          padding: 20rpx 0;\n          border-bottom: 2rpx solid #292929;\n          \n          .record-info {\n            .record-desc {\n              font-size: 28rpx;\n              color: #ddd;\n              margin-bottom: 8rpx;\n              display: block;\n            }\n            \n            .record-time {\n              font-size: 22rpx;\n              color: #777;\n            }\n          }\n          \n          .record-points {\n            font-size: 30rpx;\n            font-weight: bold;\n            \n            &.positive {\n              color: #ff6b6b;\n            }\n            \n            &.negative {\n              color: #4ecdc4;\n            }\n          }\n        }\n      }\n    }\n    \n    .coupon-list {\n      padding: 20rpx 30rpx;\n      \n      .coupon-item {\n        display: flex;\n        margin-bottom: 20rpx;\n        border-radius: 12rpx;\n        overflow: hidden;\n        height: 180rpx;\n        background: linear-gradient(to right, #222, #1a1a1a);\n        box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.2);\n        position: relative;\n        \n        &.used, &.expired {\n          opacity: 0.5;\n        }\n        \n        &::before {\n          content: '';\n          position: absolute;\n          left: 0;\n          top: 0;\n          bottom: 0;\n          width: 10rpx;\n          background-color: #ff6b6b;\n        }\n        \n        .coupon-left {\n          width: 220rpx;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          align-items: center;\n          padding-left: 30rpx;\n          \n          .coupon-amount {\n            display: flex;\n            align-items: baseline;\n            margin-bottom: 10rpx;\n            \n            .amount-prefix {\n              font-size: 26rpx;\n              color: #ff6b6b;\n              font-weight: bold;\n            }\n            \n            .amount-value {\n              font-size: 48rpx;\n              color: #ff6b6b;\n              font-weight: bold;\n              margin: 0 4rpx;\n            }\n            \n            .amount-postfix {\n              font-size: 26rpx;\n              color: #ff6b6b;\n              font-weight: bold;\n            }\n          }\n          \n          .condition {\n            font-size: 22rpx;\n            color: #999;\n          }\n        }\n        \n        .coupon-right {\n          flex: 1;\n          display: flex;\n          flex-direction: column;\n          justify-content: center;\n          padding: 0 30rpx;\n          position: relative;\n          \n          &::before {\n            content: '';\n            position: absolute;\n            left: 0;\n            top: 20rpx;\n            bottom: 20rpx;\n            width: 2rpx;\n            background-color: #333;\n            border-radius: 1rpx;\n          }\n          \n          .coupon-name {\n            font-size: 28rpx;\n            color: #fff;\n            font-weight: bold;\n            margin-bottom: 10rpx;\n          }\n          \n          .coupon-time {\n            font-size: 22rpx;\n            color: #999;\n            margin-bottom: 10rpx;\n            padding-right: 130rpx; /* 为按钮留出空间 */\n          }\n          \n          .coupon-status {\n            font-size: 22rpx;\n            color: #ff6b6b;\n          }\n          \n          .receive-btn {\n            position: absolute;\n            right: 30rpx;\n            top: 50%;\n            transform: translateY(-50%);\n            width: 120rpx;\n            height: 50rpx;\n            line-height: 50rpx;\n            text-align: center;\n            background-color: #ff6b6b;\n            color: #fff;\n            font-size: 24rpx;\n            border-radius: 25rpx;\n            padding: 0;\n          }\n        }\n        \n        &.receivable {\n          background: linear-gradient(to right, #222833, #1a1a25);\n          \n          &::before {\n            background-color: #9370db;\n          }\n          \n          .coupon-left {\n            .coupon-amount {\n              .amount-prefix, .amount-value, .amount-postfix {\n                color: #9370db;\n              }\n            }\n          }\n          \n          .coupon-right {\n            .receive-btn {\n              background-color: #9370db;\n            }\n          }\n        }\n      }\n    }\n  }\n  \n  .debug-info {\n    padding: 10rpx;\n    background-color: #222;\n    font-size: 22rpx;\n    color: #999;\n    word-break: break-all;\n    white-space: normal;\n    max-height: 200rpx;\n    overflow-y: auto;\n  }\n  \n  .point-rules-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 999;\n    \n    .modal-mask {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: rgba(0, 0, 0, 0.6);\n    }\n    \n    .modal-content {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 80%;\n      max-height: 70%;\n      background-color: #202020;\n      border-radius: 16rpx;\n      overflow: hidden;\n      box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.3);\n      \n      .modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 30rpx;\n        border-bottom: 2rpx solid #333;\n        \n        .modal-title {\n          font-size: 32rpx;\n          font-weight: bold;\n          color: #fff;\n        }\n        \n        .modal-close {\n          font-size: 40rpx;\n          color: #999;\n          padding: 0 10rpx;\n        }\n      }\n      \n      .modal-body {\n        padding: 20rpx 30rpx;\n        max-height: 600rpx;\n        overflow-y: auto;\n        \n        .rule-item {\n          padding: 20rpx 0;\n          border-bottom: 2rpx solid #333;\n          \n          &:last-child {\n            border-bottom: none;\n          }\n          \n          .rule-name {\n            font-size: 30rpx;\n            font-weight: bold;\n            color: #fff;\n            margin-bottom: 10rpx;\n          }\n          \n          .rule-desc {\n            font-size: 26rpx;\n            color: #aaa;\n            margin-bottom: 10rpx;\n          }\n          \n          .rule-value {\n            font-size: 24rpx;\n            color: #7b68ee;\n          }\n        }\n        \n        .empty-tip {\n          padding: 50rpx 0;\n          text-align: center;\n          color: #999;\n          font-size: 26rpx;\n        }\n      }\n    }\n  }\n  \n  .member-level-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    z-index: 999;\n    \n    .modal-mask {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: rgba(0, 0, 0, 0.6);\n    }\n    \n    .modal-content {\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      width: 80%;\n      max-height: 70%;\n      background-color: #202020;\n      border-radius: 16rpx;\n      overflow: hidden;\n      box-shadow: 0 4rpx 16rpx rgba(0, 0, 0, 0.3);\n      \n      .modal-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 30rpx;\n        border-bottom: 2rpx solid #333;\n        \n        .modal-title {\n          font-size: 32rpx;\n          font-weight: bold;\n          color: #fff;\n        }\n        \n        .modal-close {\n          font-size: 40rpx;\n          color: #999;\n          padding: 0 10rpx;\n        }\n      }\n      \n      .modal-body {\n        padding: 20rpx 30rpx;\n        max-height: 600rpx;\n        overflow-y: auto;\n        \n        .level-item {\n          padding: 20rpx 0;\n          border-bottom: 2rpx solid #333;\n          \n          &:last-child {\n            border-bottom: none;\n          }\n          \n          .level-header {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-bottom: 10rpx;\n            \n            .level-name {\n              font-size: 30rpx;\n              font-weight: bold;\n              color: #fff;\n            }\n            \n            .level-points {\n              font-size: 24rpx;\n              color: #999;\n            }\n          }\n          \n          .level-benefits {\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n            \n            .level-discount {\n              .benefit-label {\n                font-size: 26rpx;\n                color: #ff6b6b;\n                font-weight: bold;\n              }\n              \n              .benefit-value {\n                font-size: 24rpx;\n                color: #ff6b6b;\n              }\n            }\n            \n            .level-other-benefits {\n              .benefit-label {\n                font-size: 26rpx;\n                color: #999;\n              }\n              \n              .benefit-value {\n                font-size: 24rpx;\n                color: #999;\n              }\n            }\n          }\n        }\n        \n        .empty-tip {\n          padding: 50rpx 0;\n          text-align: center;\n          color: #999;\n          font-size: 26rpx;\n        }\n      }\n    }\n  }\n}\n</style> ","import MiniProgramPage from 'C:/Users/LXD/Desktop/奶茶点单系统/milktea-uniapp/pages/user/member-center.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api"],"mappings":"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"}