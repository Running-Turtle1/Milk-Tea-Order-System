{"version":3,"file":"change-password.js","sources":["pages/user/change-password.vue","D:/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9jaGFuZ2UtcGFzc3dvcmQudnVl"],"sourcesContent":["<template>\n\t<view class=\"change-password-container\">\n\t\t<view class=\"password-header\">\n\t\t\t<view class=\"header-title\">修改密码</view>\n\t\t</view>\n\t\t\n\t\t<view class=\"password-form\">\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">原密码</text>\n\t\t\t\t<input type=\"password\" v-model=\"oldPassword\" placeholder=\"请输入原密码\" class=\"form-input\" placeholder-style=\"color: #666666;\" />\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">新密码</text>\n\t\t\t\t<input type=\"password\" v-model=\"newPassword\" placeholder=\"请输入新密码\" class=\"form-input\" placeholder-style=\"color: #666666;\" />\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"form-item\">\n\t\t\t\t<text class=\"form-label\">确认新密码</text>\n\t\t\t\t<input type=\"password\" v-model=\"confirmPassword\" placeholder=\"请再次输入新密码\" class=\"form-input\" placeholder-style=\"color: #666666;\" />\n\t\t\t</view>\n\t\t\t\n\t\t\t<view class=\"password-rules\">\n\t\t\t\t<text class=\"rules-title\">密码要求：</text>\n\t\t\t\t<text class=\"rules-item\">• 不少于8个字符</text>\n\t\t\t\t<text class=\"rules-item\">• 包含大小写字母和数字</text>\n\t\t\t\t<text class=\"rules-item\">• 不能与旧密码相同</text>\n\t\t\t</view>\n\t\t\t\n\t\t\t<button class=\"submit-btn\" @click=\"submitPassword\">确认修改</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\n\timport api from '@/utils/api.js';\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\toldPassword: '',\n\t\t\t\tnewPassword: '',\n\t\t\t\tconfirmPassword: '',\n\t\t\t\tloading: false\n\t\t\t}\n\t\t},\n\t\tonLoad() {\n\t\t\t// 检查登录状态\n\t\t\tthis.checkLoginStatus();\n\t\t},\n\t\tmethods: {\n\t\t\t// 检查登录状态\n\t\t\tcheckLoginStatus() {\n\t\t\t\tconst token = uni.getStorageSync('token');\n\t\t\t\tif (!token) {\n\t\t\t\t\tthis.promptLogin();\n\t\t\t\t}\n\t\t\t},\n\t\t\t\n\t\t\t// 提示登录\n\t\t\tpromptLogin() {\n\t\t\t\tuni.showModal({\n\t\t\t\t\ttitle: '提示',\n\t\t\t\t\tcontent: '请先登录',\n\t\t\t\t\tconfirmText: '去登录',\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.navigateBack();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 验证密码\n\t\t\tvalidatePassword() {\n\t\t\t\tif (!this.oldPassword) {\n\t\t\t\t\tthis.showToast('请输入原密码');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!this.newPassword) {\n\t\t\t\t\tthis.showToast('请输入新密码');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.newPassword.length < 8) {\n\t\t\t\t\tthis.showToast('新密码长度不能少于8个字符');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).+$/.test(this.newPassword)) {\n\t\t\t\t\tthis.showToast('新密码必须包含大小写字母和数字');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.newPassword === this.oldPassword) {\n\t\t\t\t\tthis.showToast('新密码不能与原密码相同');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (this.newPassword !== this.confirmPassword) {\n\t\t\t\t\tthis.showToast('两次输入的新密码不一致');\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t\n\t\t\t// 提交密码修改\n\t\t\tsubmitPassword() {\n\t\t\t\tif (!this.validatePassword()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.loading = true;\n\t\t\t\t\n\t\t\t\t// 调用接口修改密码\n\t\t\t\tapi.request({\n\t\t\t\t\turl: '/user/change-password',\n\t\t\t\t\tmethod: 'PUT',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\toldPassword: this.oldPassword,\n\t\t\t\t\t\tnewPassword: this.newPassword\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\tif (res.data.code === 200) {\n\t\t\t\t\t\t\tthis.showToast('密码修改成功，请重新登录', 'success');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 清除用户登录状态\n\t\t\t\t\t\t\tuni.removeStorageSync('token');\n\t\t\t\t\t\t\tuni.removeStorageSync('userInfo');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t// 修改成功后跳转到登录页\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tuni.reLaunch({\n\t\t\t\t\t\t\t\t\turl: '/pages/login/login'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.showToast(res.data.message || '密码修改失败');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tfail: () => {\n\t\t\t\t\t\tthis.showToast('网络错误，请稍后再试');\n\t\t\t\t\t},\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tthis.loading = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\t\n\t\t\t// 显示提示信息\n\t\t\tshowToast(title, icon = 'none') {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle,\n\t\t\t\t\ticon\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\t.change-password-container {\n\t\tpadding: 20rpx;\n\t\tbackground-color: #121212;\n\t\tmin-height: 100vh;\n\t}\n\t\n\t.password-header {\n\t\tpadding: 30rpx 0;\n\t\tmargin-bottom: 20rpx;\n\t}\n\t\n\t.header-title {\n\t\tfont-size: 40rpx;\n\t\tfont-weight: bold;\n\t\tcolor: #ffffff;\n\t}\n\t\n\t.password-form {\n\t\tbackground-color: #1a1a1a;\n\t\tborder-radius: 20rpx;\n\t\tpadding: 30rpx;\n\t\tmargin-top: 30rpx;\n\t}\n\t\n\t.form-item {\n\t\tmargin-bottom: 30rpx;\n\t}\n\t\n\t.form-label {\n\t\tdisplay: block;\n\t\tfont-size: 28rpx;\n\t\tcolor: #ffffff;\n\t\tmargin-bottom: 15rpx;\n\t}\n\t\n\t.form-input {\n\t\tbackground-color: #2a2a2a;\n\t\theight: 80rpx;\n\t\tborder-radius: 10rpx;\n\t\tpadding: 0 20rpx;\n\t\tcolor: #ffffff;\n\t\twidth: 100%;\n\t\tbox-sizing: border-box;\n\t}\n\t\n\t.password-rules {\n\t\tbackground-color: #222222;\n\t\tpadding: 20rpx;\n\t\tborder-radius: 10rpx;\n\t\tmargin: 20rpx 0 40rpx;\n\t}\n\t\n\t.rules-title {\n\t\tdisplay: block;\n\t\tfont-size: 26rpx;\n\t\tcolor: #888888;\n\t\tmargin-bottom: 10rpx;\n\t}\n\t\n\t.rules-item {\n\t\tdisplay: block;\n\t\tfont-size: 24rpx;\n\t\tcolor: #888888;\n\t\tline-height: 1.6;\n\t}\n\t\n\t.submit-btn {\n\t\tbackground-color: #7b68ee;\n\t\tcolor: #ffffff;\n\t\theight: 90rpx;\n\t\tline-height: 90rpx;\n\t\tfont-size: 32rpx;\n\t\tmargin-top: 50rpx;\n\t\tborder-radius: 45rpx;\n\t}\n</style> ","import MiniProgramPage from 'C:/Users/LXD/Desktop/奶茶点单系统/milktea-uniapp/pages/user/change-password.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","api"],"mappings":";;;AAqCC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,aAAa;AAAA,MACb,aAAa;AAAA,MACb,iBAAiB;AAAA,MACjB,SAAS;AAAA,IACV;AAAA,EACA;AAAA,EACD,SAAS;AAER,SAAK,iBAAgB;AAAA,EACrB;AAAA,EACD,SAAS;AAAA;AAAA,IAER,mBAAmB;AAClB,YAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,UAAI,CAAC,OAAO;AACX,aAAK,YAAW;AAAA,MACjB;AAAA,IACA;AAAA;AAAA,IAGD,cAAc;AACbA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,aAAa;AAAA,QACb,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAChBA,0BAAAA,MAAI,WAAW;AAAA,cACd,KAAK;AAAA,YACN,CAAC;AAAA,iBACK;AACNA,0BAAG,MAAC,aAAY;AAAA,UACjB;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACD;AAAA;AAAA,IAGD,mBAAmB;AAClB,UAAI,CAAC,KAAK,aAAa;AACtB,aAAK,UAAU,QAAQ;AACvB,eAAO;AAAA,MACR;AAEA,UAAI,CAAC,KAAK,aAAa;AACtB,aAAK,UAAU,QAAQ;AACvB,eAAO;AAAA,MACR;AAEA,UAAI,KAAK,YAAY,SAAS,GAAG;AAChC,aAAK,UAAU,eAAe;AAC9B,eAAO;AAAA,MACR;AAEA,UAAI,CAAC,qCAAqC,KAAK,KAAK,WAAW,GAAG;AACjE,aAAK,UAAU,iBAAiB;AAChC,eAAO;AAAA,MACR;AAEA,UAAI,KAAK,gBAAgB,KAAK,aAAa;AAC1C,aAAK,UAAU,aAAa;AAC5B,eAAO;AAAA,MACR;AAEA,UAAI,KAAK,gBAAgB,KAAK,iBAAiB;AAC9C,aAAK,UAAU,aAAa;AAC5B,eAAO;AAAA,MACR;AAEA,aAAO;AAAA,IACP;AAAA;AAAA,IAGD,iBAAiB;AAChB,UAAI,CAAC,KAAK,oBAAoB;AAC7B;AAAA,MACD;AAEA,WAAK,UAAU;AAGfC,gBAAAA,IAAI,QAAQ;AAAA,QACX,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,UACL,aAAa,KAAK;AAAA,UAClB,aAAa,KAAK;AAAA,QAClB;AAAA,QACD,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,KAAK,SAAS,KAAK;AAC1B,iBAAK,UAAU,gBAAgB,SAAS;AAGxCD,gCAAI,kBAAkB,OAAO;AAC7BA,gCAAI,kBAAkB,UAAU;AAGhC,uBAAW,MAAM;AAChBA,4BAAAA,MAAI,SAAS;AAAA,gBACZ,KAAK;AAAA,cACN,CAAC;AAAA,YACD,GAAE,IAAI;AAAA,iBACD;AACN,iBAAK,UAAU,IAAI,KAAK,WAAW,QAAQ;AAAA,UAC5C;AAAA,QACA;AAAA,QACD,MAAM,MAAM;AACX,eAAK,UAAU,YAAY;AAAA,QAC3B;AAAA,QACD,UAAU,MAAM;AACf,eAAK,UAAU;AAAA,QAChB;AAAA,MACD,CAAC;AAAA,IACD;AAAA;AAAA,IAGD,UAAU,OAAO,OAAO,QAAQ;AAC/BA,oBAAAA,MAAI,UAAU;AAAA,QACb;AAAA,QACA;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;AACD;;;;;;;;;;;;;AClKD,GAAG,WAAW,eAAe;"}